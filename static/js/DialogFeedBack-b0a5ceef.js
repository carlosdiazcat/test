import{r as e,b as t,j as a,w as l,c6 as s,cx as o,b4 as i,b5 as n,q as u,bc as d,v as c,b7 as r,ba as f,bf as m,bb as p,b_ as v,bn as h,bg as b}from"./Akubela-element-plus-Vendor-47553b40.js";import{w as g,u as k,c as w,a as _,m as y,n as L,s as V}from"./Akubela-login-home-part-Vendor-facddf88.js";import"./Akubela-devices-img-Vendor-0f46fa2c.js";import"./Akubela-scenes-security-other-img-Vendor-2a1534ad.js";const C={class:"setting-dialog-feedback akubela-test-setting-dialog-feedback"},A={key:0},j={class:"feebback-connect-off"},x=r("div",null,"support@akubela.com",-1),D={key:1},O={class:"setting-feedback__input"},$={class:"setting__input-title"},B={class:"setting__input-left"},P={class:"setting__input-right"},R={class:"setting__input-content"},U={class:"setting-feeback-upload"},z={class:"setting-upload-title"},F=["src"],I={class:"el-upload-list__item-actions"},q=["onClick"],E=["src"],T={__name:"DialogFeedBack",props:{show:{type:Boolean,required:!0,default:!1}},emits:["update:show"],setup(T,{emit:G}){const H=T;let J=g();const{t:K}=k(),M=w(),N=e(""),Q=e(""),S=e(!1),W=e(!1),X=t({acceptData:{},fileList:[]}),Y=a({get:()=>H.show,set:e=>{G("update:show",e)}}),Z=()=>{var e,t,a;if(M.isConnectOff)return G("update:show",!1);const l=null==(t=null==(e=X.fileList)?void 0:e.map)?void 0:t.call(e,(e=>{var t,a;return null==(a=null==(t=e.base64)?void 0:t.split)?void 0:a.call(t,",")[1]}));X.acceptData[J.wId]=e=>{if(e.success)return G("update:show",!1)};const s={type:"ak_feedback/record",id:J.wId++,content:N.value};l.length>0&&l.forEach(((e,t)=>{s[`photo${t+1}`]=e})),null==(a=J.ws)||a.send(y(s))},ee=(e,t)=>{var a,l,s;return/image\/\w+/.test(null==(a=null==e?void 0:e.raw)?void 0:a.type)?e.size/1024>300?(L(K("Please upload an image smaller than 300k."),"error"),null==(s=null==t?void 0:t.pop)||s.call(t),void(X.fileList=t)):(X.fileList=t,void((null==t?void 0:t.length)>0&&X.fileList.forEach((e=>{te(e.raw).then((t=>{e.base64=t}))})))):(L(K("The uploaded file must be in image format"),"error"),null==(l=null==t?void 0:t.pop)||l.call(t),void(X.fileList=t))},te=e=>new Promise((function(t,a){let l=new FileReader,s="";l.readAsDataURL(e),l.onload=function(){s=l.result},l.onerror=function(e){a(e)},l.onloadend=function(){t(s)}}));return l((()=>J.updataId),(e=>{V(X.acceptData,e,J)}),{immediate:!0}),(e,t)=>{const a=h,l=s,g=o,k=b;return i(),n("div",C,[u(_,{show:Y.value,"onUpdate:show":t[2]||(t[2]=e=>Y.value=e),title:e.$t("Feedback"),"is-ash":!N.value,class:p(c(M).isConnectOff?"feedbakc-connect-off":""),"foot-show":!c(M).isConnectOff,onButtonConfirm:Z,onButtonCancel:t[3]||(t[3]=e=>G("update:show",!1))},{content:d((()=>{var s;return[c(M).isConnectOff?(i(),n("section",A,[r("div",j,[r("div",null,f(e.$t("Please send feedback to email"))+":",1),x])])):m("",!0),c(M).isConnectOff?m("",!0):(i(),n("section",D,[r("div",O,[r("div",$,[r("div",B,f(e.$t("Please enter feedback here"))+":",1),r("div",P,f(N.value.length||0)+"/200",1)]),r("div",R,[u(a,{modelValue:N.value,"onUpdate:modelValue":t[0]||(t[0]=e=>N.value=e),maxlength:200,autosize:{minRows:2,maxRows:10},type:"textarea",resize:"none"},null,8,["modelValue"])])]),r("div",U,[r("div",z,f(e.$t("Add pictures or file")),1),u(g,{class:p((null==(s=X.fileList)?void 0:s.length)>=3?"setting-feeb-up-file":""),action:"#","file-list":X.fileList,"list-type":"picture-card","auto-upload":!1,"on-change":ee},{file:d((({file:e})=>[r("div",null,[r("img",{alt:"smart home,home automation,homekit,smart security,smart home systems,google home",class:"el-upload-list__item-thumbnail",src:e.url},null,8,F),r("span",I,[W.value?m("",!0):(i(),n("span",{key:0,class:"el-upload-list__item-delete",onClick:t=>(e=>{var t,a;X.fileList=null==(a=null==(t=X.fileList)?void 0:t.filter)?void 0:a.call(t,(t=>(null==t?void 0:t.uid)!==(null==e?void 0:e.uid)))})(e)},[u(l,null,{default:d((()=>[u(c(v))])),_:1})],8,q))])])])),_:1},8,["class","file-list"]),u(k,{modelValue:S.value,"onUpdate:modelValue":t[1]||(t[1]=e=>S.value=e),"destroy-on-close":""},{default:d((()=>[r("img",{alt:"smart home,home automation,homekit,smart security,smart home systems,google home",src:Q.value},null,8,E)])),_:1},8,["modelValue"])])]))]})),_:1},8,["show","title","is-ash","class","foot-show"])])}}};export{T as default};
