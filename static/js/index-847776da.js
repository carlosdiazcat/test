import{o as e,_ as t,an as o,u as a,l as n,a as r,Y as l,n as s,q as i}from"./Akubela-login-home-part-Vendor-facddf88.js";import{by as d,b as c,r as u,l as g,j as m,c6 as b,bi as f,bd as p,v as w,b4 as h,b5 as v,b7 as y,q as k,bc as _,ba as S,bm as $,b9 as C,cq as x,F as j,bl as V,be as T,bf as U,bj as P,bk as O,bw as R,bx as D,bh as A}from"./Akubela-element-plus-Vendor-47553b40.js";import{_ as z}from"./index-d8b1faeb.js";import{_ as N}from"./index-722e1dac.js";import{s as B,n as E,f as I}from"./config-178dd060.js";import"./Akubela-devices-img-Vendor-0f46fa2c.js";import"./Akubela-scenes-security-other-img-Vendor-2a1534ad.js";const X=["element-loading-text"],W={class:"commen-main-box"},H={class:"card-header"},L={class:"engr-common-row"},F={class:"engr-common-row-left"},M={class:"engr-common-row-right"},q={class:"engr-common-row"},Y={class:"engr-common-row-left"},G={class:"engr-common-row-right"},J={class:"engr-common-row"},K={class:"engr-common-row-left"},Q={class:"engr-common-row-right"},Z={class:"engr-common-row"},ee={class:"engr-common-row-left"},te={class:"engr-common-row-right"},oe={class:"engr-common-row"},ae={class:"engr-common-row-left"},ne={class:"engr-common-row-right"},re={class:"engr-common-row"},le={class:"engr-common-row-left"},se={class:"engr-common-row-right"},ie={class:"engr-common-row"},de={class:"engr-common-row-left"},ce={class:"engr-common-row-right"},ue={class:"card-header text-header"},ge={class:"engr-common-row"},me={class:"engr-common-row-left"},be={class:"engr-common-row-right"},fe={class:"engr-common-row"},pe={class:"engr-common-row-left"},we={class:"engr-common-row-right"},he={class:"card-header text-header"},ve={class:"engr-common-row"},ye={class:"engr-common-row-left"},ke={class:"engr-common-row-right"},_e={class:"title-bottom-text"},Se={__name:"index",setup(Se){const $e=e(),Ce=d((()=>t((()=>import("./DialogLanguage-36b99ede.js")),["static/js/DialogLanguage-36b99ede.js","static/js/Akubela-login-home-part-Vendor-facddf88.js","static/js/Akubela-element-plus-Vendor-47553b40.js","static/js/Akubela-devices-img-Vendor-0f46fa2c.js","static/js/Akubela-scenes-security-other-img-Vendor-2a1534ad.js"]))),xe=o(),{t:je}=a();let Ve=c({loading:!1,uploading:!1,progress:0,fileObj:{},deviceModel:n.get("deviceModel")||"PS51",redcityData:[],dialogShow:!1,resetObj:{},softwareVersion:"",hardwareVersion:"",country:"",languageShow:!1,fileTitleShow:!1,deviceUpdate:[],versionObj:{},bottomtit:"",region:"",regionArray:[{label:je("Home Panel"),value:"0"},{label:je("Public Area Panel"),value:"1"}]});const Te=u(null),Ue=u(null);g((async()=>{Re(),De(),Pe()}));const Pe=()=>{B.androidFileVersion((e=>{Ve.deviceUpdate=e.result.device,Ve.versionObj=e.result.version}))},Oe=m((()=>{if(!Ve.deviceUpdate.length)return je("None");let e="";return Ve.deviceUpdate.forEach((t=>{e=e+t.name+","})),e=e.slice(0,-1),e})),Re=()=>{Ve.redcityData=E},De=()=>{B.getSettingPage((e=>{if(Ve.loading=!1,e)for(let t in e)Ve[t]=e[t]}))},Ae=()=>{const e={country:Ve.country,region:Ve.region};B.setRedCity(e,De)},ze=()=>{Te.value.changeShow()},Ne=(e,t)=>{const o=e.name.endsWith(B.updateType),a=Ve.softwareVersion.split("."),n=e.name.includes(a[0]);if(!o||!n)return s(je("Please select a valid file to upgrade."),"error"),t(!1);t(!0)},Be=e=>{Ve.resetObj=Ie[e],Ve.dialogShow=!0},Ee=()=>{Ve.resetObj.submit()},Ie={factory:{text:je("Do you want to reset to factory? All data will be cleared and the sub-device will be unbound."),submit:()=>{xe.setCtrlPanel("reset_factory")}},installer:{text:je("Do you want to reset to installer setting? Your device will be restored to its original state."),submit:()=>{xe.setCtrlPanel("reset")}},reboot:{text:je("Do you want to reboot right now?"),submit:()=>{xe.setCtrlPanel("reboot")}}},Xe=(e,t)=>{Ve.progress=t,Ve.loadingText=je("Please Wait..."),Ve.uploading=!0,"uploadError"===e&&(Ve.uploading=!1),"uploadEnd"===e&&(Ve.uploading=!1,xe.gotOut())},We=()=>{Ve.fileTitleShow=!0},He=()=>{Ve.bottomtit="",Pe(),Ue.value.changeShow()},Le=(e,t)=>{var o,a,n,r,l;Ve.bottomtit="";const d=e.name.endsWith(".bin"),c=e.name.endsWith(".ota");if(!(d||c))return s(je("wrong format"),"error"),t(!1);const u=e.name.slice(0,-4).split("-");if(2!==u.length)return s(je("wrong format"),"error"),t(!1);if(!I.includes(u[0]))return s(je("wrong format"),"error"),t(!1);if("MG13_SWITCH"===u[0]){const e=u[1].split("."),l=e[e.length-1],d=e[e.length-2];if(!i(d)||!i(l))return s(je("wrong format"),"error"),t(!1);const c=null!=(n=null==(a=null==(o=Ve.versionObj)?void 0:o[u[0]])?void 0:a.split("."))?n:[0,0,0,0],g=c[c.length-1],m=c[c.length-2],b=Number(m)>Number(d),f=Number(m)===Number(d)&&Number(g)>Number(l);return(b||f)&&(Ve.bottomtit=je("The latest upgrade package XXX already exists. Do you want to overwrite it?",{version:null==(r=Ve.versionObj)?void 0:r[u[0]]})),t(!0)}const g=u[1].slice(1);if(!i(g))return s(je("wrong format"),"error"),t(!1);const m=Number(null!=(l=Ve.versionObj[u[0]])?l:0);m>=g&&(Ve.bottomtit=je("The latest upgrade package XXX already exists. Do you want to overwrite it?",{version:`${u[0]}-V${m}.bin`})),t(!0)},Fe=(e,t)=>{Ve.loadingText=je("Please Wait..."),Ve.uploading=!0,"uploadEnd"!==e&&"uploadError"!==e||(Ve.uploading=!1,Ue.value.changeShow())},Me=()=>{Ve.languageShow=!0};return(e,t)=>{const o=P,a=O,n=b,s=f,i=R,d=D,c=A;return p((h(),v("div",{class:"engr-setting","element-loading-text":w(Ve).loadingText},[y("section",W,[k(a,null,{header:_((()=>[y("div",H,[y("span",null,S(e.$t("Basic")),1)])])),default:_((()=>[y("div",L,[y("div",F,S(e.$t("Software Version")),1),y("div",M,S(w(Ve).softwareVersion),1)]),p(y("div",q,[y("div",Y,S(e.$t("Hardware Version")),1),y("div",G,S(w(Ve).hardwareVersion),1)],512),[[$,!["C319H","X933H"].includes(Ve.deviceModel)]]),y("div",J,[y("div",K,S(e.$t("Upgrade")),1),y("div",Q,[k(o,{"akubela-test":"engr-setting-upgrade",type:"primary",size:"large",onClick:ze},{default:_((()=>[C(S(e.$t("Import")),1)])),_:1})])]),y("div",Z,[y("div",ee,S(e.$t("Reset To Factory Setting")),1),y("div",te,[k(o,{type:"primary",size:"large",onClick:t[0]||(t[0]=e=>Be("factory"))},{default:_((()=>[C(S(e.$t("Reset")),1)])),_:1})])]),y("div",oe,[y("div",ae,S(e.$t("Reset to Installer Setting")),1),y("div",ne,[k(o,{"akubela-test":"engr-setting-installer",type:"primary",size:"large",onClick:t[1]||(t[1]=e=>Be("installer"))},{default:_((()=>[C(S(e.$t("Reset")),1)])),_:1})])]),y("div",re,[y("div",le,S(e.$t("Reboot")),1),y("div",se,[k(o,{"akubela-test":"engr-setting-reboot",type:"primary",size:"large",onClick:t[2]||(t[2]=e=>Be("reboot"))},{default:_((()=>[C(S(e.$t("Reboot")),1)])),_:1})])]),y("div",ie,[y("div",de,S(e.$t("Language")),1),y("div",ce,[k(o,{"akubela-test":"engr-setting-lang",type:"primary",size:"large",onClick:Me},{default:_((()=>[C(S(e.$t("Setting")),1)])),_:1})])])])),_:1}),k(a,{class:"engr-setting-second"},{header:_((()=>[y("div",ue,[y("span",null,S(e.$t("Country")),1),k(s,{class:"box-item",effect:"light",content:e.$t("Select a country for adapting the infrared code library. If the configured country is not within the range of countries supported by the infrared code library, it defaults to US."),placement:"top","raw-content":!0},{default:_((()=>[k(n,null,{default:_((()=>[k(w(x))])),_:1})])),_:1},8,["content"])])])),default:_((()=>[y("div",ge,[y("div",me,S(e.$t("Country")),1),y("div",be,[k(d,{modelValue:w(Ve).country,"onUpdate:modelValue":t[3]||(t[3]=e=>w(Ve).country=e),"akubela-test":"engr-setting-Country",filterable:"",size:"large"},{default:_((()=>[(h(!0),v(j,null,V(w(Ve).redcityData,(e=>(h(),T(i,{key:e.value,"akubela-test":`engr-setting-Country-options-${e.name===w(Ve).country}`,label:e.label,value:e.value},null,8,["akubela-test","label","value"])))),128))])),_:1},8,["modelValue"])])])])),_:1}),k(a,{class:"engr-setting-second"},{header:_((()=>[y("div",{class:"card-header text-header",onClick:We},[y("span",null,S(e.$t("Accessories")),1),k(n,null,{default:_((()=>[k(w(x))])),_:1})])])),default:_((()=>[y("div",fe,[y("div",pe,S(e.$t("Upgrade")),1),y("div",we,[k(o,{type:"primary",size:"large",onClick:He},{default:_((()=>[C(S(e.$t("Import")),1)])),_:1})])])])),_:1}),w($e).getIsPublic?(h(),T(a,{key:0,class:"engr-setting-second"},{header:_((()=>[y("div",he,[y("span",null,S(e.$t("Region")),1)])])),default:_((()=>[y("div",ve,[y("div",ye,S(e.$t("Region")),1),y("div",ke,[k(d,{modelValue:w(Ve).region,"onUpdate:modelValue":t[4]||(t[4]=e=>w(Ve).region=e),"akubela-test":"engr-setting-Country",filterable:"",size:"large"},{default:_((()=>[(h(!0),v(j,null,V(w(Ve).regionArray,(e=>(h(),T(i,{key:e.value,"akubela-test":`engr-setting-Country-options-${e.name===w(Ve).country}`,label:e.label,value:e.value},null,8,["akubela-test","label","value"])))),128))])),_:1},8,["modelValue"])])])])),_:1})):U("",!0)]),k(N,{onCancel:De,onSubmit:Ae}),k(r,{show:w(Ve).dialogShow,"onUpdate:show":t[5]||(t[5]=e=>w(Ve).dialogShow=e),"button-cancel-show":!0,"button-ok-name":e.$t("Confirm"),onButtonCancel:t[6]||(t[6]=e=>w(Ve).dialogShow=!1),onButtonConfirm:Ee},{content:_((()=>[y("div",null,S(w(Ve).resetObj.text),1)])),_:1},8,["show","button-ok-name"]),k(z,{ref_key:"firmwareFileRef",ref:Ue,accept:".bin,.ota","api-fun":w(l).uploazigbee,bottomtit:w(Ve).bottomtit,onBeforeUpdate:Le,onLoadingChange:Fe},null,8,["api-fun","bottomtit"]),k(z,{ref_key:"fileRef",ref:Te,compare:!0,accept:w(B).updateType,"api-fun":w(l).upgrade,onBeforeUpdate:Ne,onLoadingChange:Xe},null,8,["accept","api-fun"]),k(r,{show:w(Ve).fileTitleShow,"onUpdate:show":t[7]||(t[7]=e=>w(Ve).fileTitleShow=e),"button-cancel-show":!1,"button-ok-name":e.$t("Done"),class:"setting-title-show",onButtonCancel:t[8]||(t[8]=e=>w(Ve).fileTitleShow=!1),onButtonConfirm:t[9]||(t[9]=e=>w(Ve).fileTitleShow=!1)},{content:_((()=>[y("div",null,S(e.$t("This function can be used to upload programs to the following devices for upgrade")),1),y("div",_e,S(Oe.value),1)])),_:1},8,["show","button-ok-name"]),w(Ve).languageShow?(h(),T(w(Ce),{key:0,show:w(Ve).languageShow,"onUpdate:show":t[10]||(t[10]=e=>w(Ve).languageShow=e)},null,8,["show"])):U("",!0)],8,X)),[[c,w(Ve).loading],[c,w(Ve).uploading,void 0,{fullscreen:!0,lock:!0}]])}}};export{Se as default};
