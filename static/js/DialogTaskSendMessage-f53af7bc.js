import{b as e,l as s,j as t,w as a,b4 as o,b5 as n,q as i,bc as l,b7 as d,ba as c,F as r,bl as u,bb as m,bf as p,bn as v}from"./Akubela-element-plus-Vendor-47553b40.js";import{j as h,u as w,w as f,m as g,n as b,a as _,s as y}from"./Akubela-login-home-part-Vendor-facddf88.js";import"./Akubela-devices-img-Vendor-0f46fa2c.js";import"./Akubela-scenes-security-other-img-Vendor-2a1534ad.js";const k={class:"scenes-dia-send-message"},x={class:"scene-message-content"},T={class:"condition-content-box"},j={class:"condition-row-left"},S={class:"condition-left__span"},V=d("div",{class:"condition-row-right"},[d("div",{class:"common-row-triangle"})],-1),B={key:0,class:"condition-content-child"},C=["onClick"],D={class:"condition-child-row__left condition-left-max-setting"},L={class:"condition-child-row__right"},A={class:"setting-feedback__input"},I={class:"setting__input-title"},$={class:"setting__input-left"},F={class:"setting__input-content"},M={__name:"DialogTaskSendMessage",props:{show:{type:Boolean,required:!0,default:!1}},emits:["update:show","open-dia-show","set-add-obj","pop-closed"],setup(M,{emit:q}){const G=M;let P=h();const{t:R}=w();let U=f();const z=e({recevieData:{},sendText:"",defaultShow:!0,familyList:[]});s((()=>{z.loading=!0,setTimeout((()=>{E()}),1e3)}));const E=()=>{var e;z.recevieData[U.wId]=H;const s={mode:1,type:"homeassistant/contacts_automation",id:U.wId++};z.loading=!0,setTimeout((()=>{z.loading=!1}),1e4),null==(e=U.ws)||e.send(g(s))},H=e=>{var s,t;if(z.loading=!1,!e.success)return b(R("errorMessage"),"error");z.familyList=null==(t=null==(s=e.result)?void 0:s.filter)?void 0:t.call(s,(e=>e.id!==P.mainDeviceId)).map((e=>"Family Group"===(null==e?void 0:e.name)?{...e,name:R("Family Group")}:e))},J=()=>{q("open-dia-show"),q("update:show",!1)},K=()=>{q("update:show",!1),q("pop-closed")},N=()=>{var e,s,t,a;const o={send_message:z.sendText,target_ids:null==(a=null==(t=null==(s=null==(e=z.familyList)?void 0:e.filter)?void 0:s.call(e,(e=>e.selected)))?void 0:t.map)?void 0:a.call(t,(e=>e.id))};q("set-add-obj",o),q("update:show",!1),z.sendText=""},O=t({get:()=>G.show,set:e=>{q("update:show",e)}}),Q=t((()=>{var e,s;return z.sendText&&(null==(s=null==(e=z.familyList)?void 0:e.some)?void 0:s.call(e,(e=>e.selected)))}));return a((()=>U.updataId),(e=>{y(z.recevieData,e,U)}),{immediate:!0}),(e,s)=>{const t=v;return o(),n("div",k,[i(_,{show:O.value,"onUpdate:show":s[2]||(s[2]=e=>O.value=e),"back-show":!0,"is-ash":!Q.value,title:e.$t("Send Message"),loading:z.loading,onButtonCancel:K,onButtonBack:J,onButtonConfirm:N},{content:l((()=>[d("div",x,[d("div",T,[d("div",{class:"condition-content-row",onClick:s[0]||(s[0]=e=>z.defaultShow=!z.defaultShow)},[d("div",j,[d("span",S,c(e.$t("Send To")),1)]),V]),z.defaultShow?(o(),n("div",B,[(o(!0),n(r,null,u(z.familyList,(e=>(o(),n("div",{key:e.id,class:"condition-child-row",onClick:s=>(e=>{e.selected=!e.selected})(e)},[d("div",D,c(e.name),1),d("div",L,[d("span",{class:m([e.selected?"modify-more-right-active":" ","modify-more-right"])},null,2)])],8,C)))),128))])):p("",!0)])]),d("div",A,[d("div",I,[d("div",$,c(e.$t("Please enter content here"))+":",1)]),d("div",F,[i(t,{modelValue:z.sendText,"onUpdate:modelValue":s[1]||(s[1]=e=>z.sendText=e),maxlength:256,type:"textarea",autosize:{minRows:3,maxRows:15},placeholder:e.$t("Please enter content here")},null,8,["modelValue","placeholder"])])])])),_:1},8,["show","is-ash","title","loading"])])}}};export{M as default};
