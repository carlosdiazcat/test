import{_ as e,u as t,j as o,w as s,s as i,am as a,S as n,g as d,a as r,a0 as l,n as c,m as u}from"./Akubela-login-home-part-Vendor-facddf88.js";import{by as h,r as m,b as v,j as g,w,b4 as p,b5 as b,bd as _,be as f,bc as k,ba as S,bf as y,F as j,bl as D,b7 as T,q as A,v as C,b9 as x,bs as L,bn as B,bA as I,bB as O,bh as V}from"./Akubela-element-plus-Vendor-47553b40.js";import"./Akubela-devices-img-Vendor-0f46fa2c.js";import"./Akubela-scenes-security-other-img-Vendor-2a1534ad.js";const E={key:0,class:"linked-text"},$={key:1,class:"dia-devices-list"},G={class:"dia-row-left"},U={class:"devices-content-detail"},M={class:"devices-content-name"},P=["onClick"],q={key:2,class:"dia-devices-no-data"},F=["src"],N=["src"],R={class:"edit-name__input-content"},z={__name:"DeviceDialogLightGroupSecond",props:{show:{type:Boolean,required:!0,default:!1},title:{type:String,default:"Title"},groupObj:{type:Object,default:()=>{}}},emits:["update:show","getList","change-name"],setup(z,{emit:H}){const Y=z,J=h((()=>e((()=>import("./DeviceDialogLightGroupThird-1520870b.js")),["static/js/DeviceDialogLightGroupThird-1520870b.js","static/js/Akubela-element-plus-Vendor-47553b40.js","static/js/Akubela-login-home-part-Vendor-facddf88.js","static/js/Akubela-devices-img-Vendor-0f46fa2c.js","static/js/Akubela-scenes-security-other-img-Vendor-2a1534ad.js"]))),{t:K}=t(),Q=o(),{deviceCardObj:W}=Q,X=m(),Z=s(),ee=v({recevieData:{},devicesList:[],loading:!1,allShow:!1,deleteShowDialog:!1,is_bindArr:[],editShow:!1,form:{sendText:""},rules:{sendText:[{validator:(e,t,o)=>{var s;const i=Q.devicesList.find((e=>e.name===t));if(i&&(null==(s=Y.groupObj)?void 0:s.device_id)!==i.device_id)return o(new Error(K("The name already exists.")));const a=(new TextEncoder).encode(t).length;if(!t||a>63)return o(new Error(K("Please enter a name no longer than 63 characters.")));o()},trigger:["change","blur"]}]}}),te=()=>{ee.editShow=!1,ee.form.sendText=""},oe=l((()=>{X.value.validate((async e=>{var t,o;if(e){ee.recevieData[Z.wId]=e=>{if(!e.success)return c(K("errorMessage"),"error");H("change-name",ee.form.sendText),te()};const e={type:"config/ak_device/update",device_id:null==(t=Y.groupObj)?void 0:t.device_id,id:Z.wId++,name:ee.form.sendText};null==(o=Z.ws)||o.send(u(e))}}))})),se=()=>{ee.form.sendText=Y.title,ee.editShow=!0},ie=()=>{ee.allShow=!0},ae=()=>{H("update:show",!1),H("getList")},ne=()=>{var e,t;ee.recevieData[Z.wId]=e=>{if(ee.loading=!1,!e.success)return c(K("errorMessage"),"error");ee.devicesList=e.result;let t=[];ee.devicesList.forEach((e=>{e.is_bind&&t.push(e)})),ee.is_bindArr=t};const o={type:"ak_device/light_group/support_devices",device_id:null==(e=Y.groupObj)?void 0:e.device_id,id:Z.wId++};setTimeout((()=>{ee.loading=!1}),5e3),ee.loading=!0,null==(t=Z.ws)||t.send(u(o))},de=l((()=>{var e,t;ee.deleteShowDialog=!1,ee.recevieData[Z.wId]=e=>{var t;if(!e.success)return c(K("errorMessage"),"error");ae(),2===(null==(t=W.deviceDetail)?void 0:t.group_ctrl)&&(Q.deviceCurrent.dialogVisible=!1)};const o={type:"config/ak_device/delete",device_id:null==(e=Y.groupObj)?void 0:e.device_id,id:Z.wId++};null==(t=Z.ws)||t.send(u(o))})),re=l((e=>{var t,o;if(1===ee.is_bindArr.length)return void(ee.deleteShowDialog=!0);ee.recevieData[Z.wId]=e=>{if(!e.success)return c(K("errorMessage"),"error");ne()};const s={type:"ak_device/light_group/update",device_id:null==(t=Y.groupObj)?void 0:t.device_id,link_device_id:null==e?void 0:e.device_id,mode:2,id:Z.wId++};null==(o=Z.ws)||o.send(u(s))})),le=g({get:()=>Y.show,set:e=>{H("update:show",e)}});return w((()=>Z.updataId),(e=>{i(ee.recevieData,e,Z)}),{immediate:!0}),w((()=>Y.show),(e=>{e&&ne()})),(e,t)=>{const o=B,s=I,i=O,l=V;return p(),b(j,null,[_((p(),f(r,{show:le.value,"onUpdate:show":t[1]||(t[1]=e=>le.value=e),class:"dia-light-group-second",title:Y.title,"foot-show":!1,"back-show":!0,"edit-title-name":!0,onButtonBack:ae,onButtonCancel:ae,onShowEditTitleName:se},{content:k((()=>[ee.is_bindArr.length>0?(p(),b("div",E,S(e.$t("Grouped Light/Switch")),1)):y("",!0),ee.is_bindArr.length>0?(p(),b("div",$,[(p(!0),b(j,null,D(ee.is_bindArr,(e=>(p(),b("div",{key:e.device_id,class:"dia-devices-row"},[T("div",G,[A(a,{"card-obj":e,"class-name":"trans"},null,8,["card-obj"]),T("div",U,[T("div",M,[A(n,{content:e.name},null,8,["content"])])])]),T("div",{class:"dia-row-right",onClick:t=>C(re)(e)},null,8,P)])))),128))])):y("",!0),ee.is_bindArr.length<=0?(p(),b("div",q)):y("",!0),T("div",{class:"current-add-button",onClick:ie},[T("img",{class:"current-add-button-icon",alt:"smart home,home automation,homekit,smart security,smart home systems,google home",src:C(d)("add_hover.webp")},null,8,F),x(" "+S(e.$t("Link Light/Swtich")),1)]),ee.is_bindArr.length>0?(p(),b("div",{key:3,class:"del-group-btn",onClick:t[0]||(t[0]=e=>ee.deleteShowDialog=!0)},[T("img",{class:"current-add-button-icon",alt:"smart home,home automation,homekit,smart security,smart home systems,google home",src:C(d)("delete_Hover.webp")},null,8,N),x(" "+S(e.$t("Delete Group")),1)])):y("",!0)])),_:1},8,["show","title"])),[[l,ee.loading,void 0,{fullscreen:!0,lock:!0}]]),A(C(J),{show:ee.allShow,"onUpdate:show":t[2]||(t[2]=e=>ee.allShow=e),"group-obj":Y.groupObj,onGetList:ne,onCloseSecond:ae},null,8,["show","group-obj"]),A(r,{show:ee.deleteShowDialog,"onUpdate:show":t[3]||(t[3]=e=>ee.deleteShowDialog=e),class:"show-del-group","button-cancel-show":!0,"button-ok-name":e.$t("Sure"),onButtonCancel:t[4]||(t[4]=e=>ee.deleteShowDialog=!1),onButtonConfirm:C(de)},{content:k((()=>[T("div",null,S(e.$t("You will delete this group Are you sure?")),1)])),_:1},8,["show","button-ok-name","onButtonConfirm"]),A(r,{show:ee.editShow,"onUpdate:show":t[7]||(t[7]=e=>ee.editShow=e),class:"edit-name-group",title:e.$t("Edit Name"),"button-cancel-show":!0,onButtonCancel:te,onButtonConfirm:C(oe)},{content:k((()=>[T("div",R,[A(i,{ref_key:"ruleFormRef",ref:X,model:ee.form,rules:ee.rules,onSubmit:t[6]||(t[6]=L((()=>{}),["prevent"]))},{default:k((()=>[A(s,{prop:"sendText"},{default:k((()=>[A(o,{modelValue:ee.form.sendText,"onUpdate:modelValue":t[5]||(t[5]=e=>ee.form.sendText=e),size:"large",placeholder:e.$t("Please enter")},null,8,["modelValue","placeholder"])])),_:1})])),_:1},8,["model","rules"])])])),_:1},8,["show","title","onButtonConfirm"])],64)}}};export{z as default};
