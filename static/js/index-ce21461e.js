import{b as e,j as l,w as t,bd as a,b4 as o,be as s,bc as i,b5 as n,b7 as d,ba as c,v as r,bf as u,F as m,bl as v,q as p,bh as h,r as b,l as g,b9 as w,bm as _,bq as f,bb as y,n as C,bn as k,p as S,br as j,bj as x,bo as L,cd as P,ce as $,cf as O,cg as D,bw as V,bx as N,bA as T,bB as U}from"./Akubela-element-plus-Vendor-47553b40.js";import{u as A,w as I,s as M,g as R,S as z,a as B,a0 as F,n as E,m as q,a4 as W,j as H,e as G,am as K,al as Q,l as X,a7 as Y,an as J,q as Z,ao as ee,ap as le,Q as te}from"./Akubela-login-home-part-Vendor-facddf88.js";import{s as ae,h as oe,c as se,a as ie}from"./index-8f4b869f.js";import{_ as ne}from"./AddDeviceScan-3d850729.js";import{_ as de}from"./index-d8b1faeb.js";import"./Akubela-devices-img-Vendor-0f46fa2c.js";import"./Akubela-scenes-security-other-img-Vendor-2a1534ad.js";import"./AddSettingDevcie-8f47d357.js";const ce={key:0,class:"linked-text"},re={class:"tip"},ue=["src"],me={key:1,class:"dia-devices-list"},ve=["onClick"],pe={class:"dia-row-left"},he=["src"],be={class:"devices-content-detail"},ge={class:"devices-content-name"},we=["src"],_e={key:2,class:"dia-devices-no-data"},fe={__name:"diaRelatedDoor",props:{show:{type:Boolean,required:!0,default:!1},cardObj:{type:Object,required:!0,default:()=>{}}},emits:["update:show"],setup(b,{emit:g}){const w=b,{t:_}=A(),f=e({acceptData:{},devicesList:[],loading:!1,isSelectedAll:!0}),y=I(),C=l({get:()=>w.show,set:e=>{g("update:show",e)}}),k=()=>{g("update:show",!1)},S=F((()=>{var e,l,t,a;f.acceptData[y.wId]=e=>{if(f.loading=!1,!e.success)return E(_("errorMessage"),"error");k()};let o=[];if(f.devicesList.forEach((e=>{e.is_bind&&o.push({id:e.id,device_id:e.device_id,index:e.index,name:e.name,relay_type:e.relay_type,lock_type:e.lock_type})})),!o.length)return E(_("At Least One Required"),"error");const s={type:"ak_device/door_phone/update_link_lock",link_lock_list:o,id:y.wId++};(null==(e=w.cardObj)?void 0:e.device_id)?s.device_id=null==(l=w.cardObj)?void 0:l.device_id:s.mac=null==(t=w.cardObj)?void 0:t.mac,setTimeout((()=>{f.loading=!1}),5e3),f.loading=!0,null==(a=y.ws)||a.send(q(s))})),j=()=>{f.isSelectedAll=!f.isSelectedAll,f.devicesList.forEach((e=>{f.isSelectedAll?e.is_bind=!0:e.is_bind=!1}))};return t((()=>y.updataId),(e=>{M(f.acceptData,e,y)}),{immediate:!0}),t((()=>w.show),(e=>{e&&(()=>{var e,l,t,a;f.acceptData[y.wId]=e=>{if(f.loading=!1,!e.success)return E(_("errorMessage"),"error");const l=e.result.find((e=>{e.is_bind}));f.isSelectedAll=!l,f.devicesList=e.result};const o={type:"ak_device/door_phone/get_link_lock",need_all_lock:!0,id:y.wId++};(null==(e=w.cardObj)?void 0:e.device_id)?o.device_id=null==(l=w.cardObj)?void 0:l.device_id:o.mac=null==(t=w.cardObj)?void 0:t.mac,setTimeout((()=>{f.loading=!1}),5e3),f.loading=!0,f.devicesList=[],null==(a=y.ws)||a.send(q(o))})()})),(e,l)=>{const t=h;return a((o(),s(B,{show:C.value,"onUpdate:show":l[0]||(l[0]=e=>C.value=e),"foot-show":!0,"back-show":!1,"button-cancel-show":!0,class:"dia-related-door",title:e.$t("Related Door"),onButtonCancel:k,onButtonConfirm:r(S)},{content:i((()=>[f.devicesList.length>0?(o(),n("div",ce,[d("div",re,c(e.$t("Locks that can be opened when the door phone is on a call")),1),d("img",{alt:"smart home",class:"bottom-buttons__cancel__icon",src:f.isSelectedAll?r(R)("security/deselect_all_selected.webp"):r(R)("security/deselect_all.webp"),onClick:j},null,8,ue)])):u("",!0),f.devicesList.length>0?(o(),n("div",me,[(o(!0),n(m,null,v(f.devicesList,(e=>(o(),n("div",{key:e.device_id,class:"dia-devices-row",onClick:l=>(e=>{e.is_bind=!e.is_bind})(e)},[d("div",pe,[d("img",{class:"card_open_door-img",alt:"smart home,home automation,homekit,smart security,smart home systems,google home",src:r(R)("card_open_door.webp")},null,8,he),d("div",be,[d("div",ge,[p(z,{content:e.name},null,8,["content"])])])]),d("img",{class:"dialog-img-select-all-right",alt:"smart home,home automation,homekit,smart security,smart home systems,google home",src:e.is_bind?r(R)("Checkbox_actvie.webp"):r(R)("Checkbox.webp")},null,8,we)],8,ve)))),128))])):(o(),n("div",_e,c(e.$t("No Data")),1))])),_:1},8,["show","title","onButtonConfirm"])),[[t,f.loading,void 0,{fullscreen:!0,lock:!0}]])}}},ye={class:"setup-device-card"},Ce={class:"setup-device-card-top"},ke={class:"setup-device-card-top-name"},Se={key:0,class:"setup-device-card-top-name-home"},je={class:"setup-device-card-top-name-box"},xe={class:"setup-box"},Le={class:"setup-box-row"},Pe={class:"setup-box-row-left"},$e={class:"setup-box-row-right"},Oe={class:"setup-box-row"},De={class:"setup-box-row-left"},Ve={class:"setup-box-row-right"},Ne={class:"setup-box-row"},Te={class:"setup-box-row-left"},Ue={class:"setup-box-row-right"},Ae={key:0,class:"setup-box-row"},Ie={class:"setup-box-row-left"},Me={class:"setup-box-row-right"},Re={key:1,class:"setup-box-row"},ze={class:"setup-box-row-left"},Be={class:"setup-box-row-right"},Fe={key:2,class:"setup-box-row"},Ee={class:"setup-box-row-left"},qe={class:"setup-box-row-right setup-box-ak-toop"},We={key:3,class:"setup-box-row"},He={class:"setup-box-row-left"},Ge={class:"setup-box-row-right"},Ke={class:"setup-box-row"},Qe={class:"setup-box-row-left"},Xe={class:"setup-box-row-right"},Ye=["src"],Je=["src"],Ze=["src"],el={__name:"device-card",props:{deviceObj:{type:Object,default:()=>({})}},emits:["open-scan"],setup(l,{emit:t}){const v=l;W();let h=H();const{t:S}=A();let j=I(),x=G();const L=e({acceptData:{},editShow:!1,showName:"",name:"",allShow:!1,isShowModal:!0,allShow:!1,isShowNameRe:!1,isDoorPhone:!1}),P=b(null);g((()=>{O()}));const $=()=>{L.allShow=!0},O=()=>{var e;L.showName=v.deviceObj.name,L.isDoorPhone=v.deviceObj.isDoorPhone;({X933H:!0,C319H:!0})[null==(e=v.deviceObj)?void 0:e.device_type]&&(L.isShowModal=!1)},D={0:S("None"),1:S("OnCloud"),2:S("Local"),3:S("No Home Center"),4:S("No Cloud Services")},V=()=>{C((()=>{P.value.blur()}))},N={0:S("Ladder door machine"),1:S("Entrance Machine"),4:S("wall mounted unit"),50:S("Access control")},T=()=>{var e;return v.deviceObj.isDoorPhone&&(null==N?void 0:N[null==(e=v.deviceObj)?void 0:e.type])||v.deviceObj.model},U=()=>{var e;return!(se()&&!(null==(e=v.deviceObj)?void 0:e.ip))&&"G31"!==T()},M=()=>{L.name=v.deviceObj.name,L.showName=v.deviceObj.name,L.isShowNameRe=!1},F=()=>{L.isShowNameRe=!1,q()},q=()=>{var e;L.editShow=!1,x.componentRececieData[null==j?void 0:j.wId]=e=>{var l;if(!(null==e?void 0:e.success))return L.showName=v.deviceObj.name,E(S(null==(l=null==e?void 0:e.error)?void 0:l.code),"error");L.showName=L.name},x.deviceNameChange(L.name,null==(e=v.deviceObj)?void 0:e.device_id)},Y=()=>L.editShow?J()?void q():(L.showName=L.name,L.editShow=!1,void(L.isShowNameRe=!0)):(L.editShow=!0,L.name=v.deviceObj.name,void C((()=>{P.value.focus()}))),J=()=>{var e,l,t,a;if(L.name=L.name.replace(Q.regSpace,""),!L.name)return L.name=v.deviceObj.name,E(S("nameEmpty"),"error"),!1;return!(null==(a=null==(t=null==(l=null==(e=null==h?void 0:h.devicesList)?void 0:e.filter)?void 0:l.call(e,(e=>e.device_id!==v.deviceObj.device_id)))?void 0:t.find)?void 0:a.call(t,(e=>e.name===L.name)))},Z={Wifi:S("WiFi"),Wired:S("Wired")},ee=()=>{var e,l,t,a;return(null==(e=v.deviceObj)?void 0:e.online)?(null==Z?void 0:Z[null==(l=v.deviceObj)?void 0:l.network])?null==Z?void 0:Z[null==(t=v.deviceObj)?void 0:t.network]:S("wifiname wifi",{wifiname:null==(a=v.deviceObj)?void 0:a.network}):"--"},le={RT61:e=>30===e?"":e<31?":8080":"",PS51:e=>e<31?":8080/#":"",PG71:e=>e<31?":8080/#":""},te=()=>{var e,l,t,a,o,s,i;if(null==(e=v.deviceObj)?void 0:e.online){if(!v.deviceObj.ip)return E(S("Empty IP Address"),"error");if(L.isDoorPhone)window.open("http://"+v.deviceObj.ip);else{let e="";const n=null==(t=null==(l=v.deviceObj)?void 0:l.software)?void 0:t.split("."),d=Number(n[2]);le[null==(a=v.deviceObj)?void 0:a.model]&&(e=le[null==(o=v.deviceObj)?void 0:o.model](d));let c="http://"+v.deviceObj.ip+e+`?engrmode=admin&password=${window.btoa("engypass"+(null==(s=X.getItem("loginPassWord"))?void 0:s.value))}`;(null==(i=v.deviceObj)?void 0:i.homecenter)&&(c="http://"+location.host+e+"/engr/status"),window.open(c)}}},ae=()=>{var e,l;(null==(e=v.deviceObj)?void 0:e.online)&&t("open-scan",null==(l=v.deviceObj)?void 0:l.device_id)},oe=()=>"CT61"!==T()&&!L.isDoorPhone,se=()=>"CT61"!==T()&&!oe();return(e,t)=>{var v,h,b,g,C,S,j,x,O;const N=k;return o(),n(m,null,[d("div",ye,[d("div",Ce,[p(K,{class:"setup-device-card-top_img","card-obj":l.deviceObj,online:null==(v=l.deviceObj)?void 0:v.online},null,8,["card-obj","online"]),d("div",ke,[(null==(h=l.deviceObj)?void 0:h.homecenter)?(o(),n("div",Se,c(e.$t("Home Center")),1)):u("",!0),d("div",je,[w(c(e.$t("Name:"))+" ",1),L.editShow?u("",!0):(o(),s(z,{key:0,content:L.showName},null,8,["content"])),a(p(N,{ref_key:"elNameInput",ref:P,modelValue:L.name,"onUpdate:modelValue":t[0]||(t[0]=e=>L.name=e),class:"akubela-device-name__input",minlength:1,maxlength:63,autofocus:!0,onKeyup:f(V,["enter"]),onBlur:Y},null,8,["modelValue","onKeyup"]),[[_,L.editShow]]),L.isDoorPhone?u("",!0):(o(),n("div",{key:1,class:"device__name__svg",onClick:Y}))])])]),d("div",xe,[d("div",Le,[d("span",Pe,c(e.$t("Model:")),1),d("span",$e,c(T()),1)]),d("div",Oe,[d("span",De,c(e.$t("IP:")),1),d("span",Ve,c((null==(b=l.deviceObj)?void 0:b.ip)||"--"),1)]),d("div",Ne,[d("span",Te,c(e.$t("MAC:")),1),d("span",Ue,c(null==(g=l.deviceObj)?void 0:g.mac),1)]),L.isDoorPhone?u("",!0):(o(),n("div",Ae,[d("span",Ie,c(e.$t("AB-UID:")),1),d("span",Me,c(null==(C=l.deviceObj)?void 0:C.ab_uid),1)])),!L.isDoorPhone&&L.isShowModal?(o(),n("div",Re,[d("span",ze,c(e.$t("Mounted Module:")),1),d("span",Be,c(null==(S=l.deviceObj)?void 0:S.base_module),1)])):u("",!0),L.isDoorPhone?u("",!0):(o(),n("div",Fe,[d("span",Ee,c(e.$t("Network:")),1),d("span",qe,[p(z,{content:ee()},null,8,["content"])])])),L.isDoorPhone?u("",!0):(o(),n("div",We,[d("span",He,c(e.$t("ConnectStates:")),1),d("span",Ge,c(D[null==(j=l.deviceObj)?void 0:j.status]||"--"),1)])),d("div",Ke,[d("span",Qe,c(e.$t("SIP")),1),d("span",Xe,c((null==(x=l.deviceObj)?void 0:x.sip)||"--"),1)])]),d("div",{class:y(["setup-bottom",{"setup-bottom-off":!(null==(O=l.deviceObj)?void 0:O.online)}])},[U()?(o(),n("div",{key:0,class:"setup-bottom-setting",onClick:te},[d("img",{src:r(R)("setingmode.webp"),class:"setup-bottom-setting__img"},null,8,Ye),p(z,{content:e.$t("Setting")},null,8,["content"])])):u("",!0),oe()?(o(),n("div",{key:1,class:"setup-bottom-setting",onClick:ae},[d("img",{src:r(R)("setingmode.webp"),class:"setup-bottom-setting__img"},null,8,Je),p(z,{content:e.$t("Add Subdevice")},null,8,["content"])])):u("",!0),se()?(o(),n("div",{key:2,class:"setup-bottom-setting",onClick:$},[d("img",{src:r(R)("setingmode.webp"),class:"setup-bottom-setting__img"},null,8,Ze),p(z,{content:e.$t("Related Door")},null,8,["content"])])):u("",!0)],2)]),p(fe,{show:L.allShow,"onUpdate:show":t[1]||(t[1]=e=>L.allShow=e),"card-obj":l.deviceObj},null,8,["show","card-obj"]),p(B,{show:L.isShowNameRe,"onUpdate:show":t[2]||(t[2]=e=>L.isShowNameRe=e),class:"tip-dia-re","button-cancel-show":!0,"button-ok-name":e.$t("Confirm"),onButtonCancel:M,onButtonConfirm:F},{content:i((()=>[d("div",null,c(e.$t("The name already exists. Continue?")),1)])),_:1},8,["show","button-ok-name"])],64)}}},ll={class:"setup-device-list"},tl={class:"setup-device-list-top"},al=["src"],ol={class:"setup-device-list-top-font"},sl={class:"setup-device-list-card"},il={__name:"device-list",setup(l){const t=H(),i=Y(),u=ae(),b=e({loading:!1,cardList:[],scanShow:!1});g((()=>{t.setUpModeFun=w,w()})),S((()=>{t.setUpModeFun=""}));const w=()=>{b.loading=!0,setTimeout((()=>{b.loading=!1}),2e4);u.componentObjFun.deviceList=()=>{b.loading=!1},u.getPannelList()},_=()=>{b.scanShow=!1},f=e=>{i.gateWayDeviceId=e,b.scanShow=!0};return(e,l)=>{const t=h;return a((o(),n("div",ll,[d("div",tl,[d("img",{alt:"smart home,home automation,homekit,smart security,smart home systems,google home",class:"setup-device-list-top__img",src:r(R)("home/home_device.webp")},null,8,al),d("div",ol,c(e.$t("Devices List")),1)]),d("div",sl,[(o(!0),n(m,null,v(r(u).cardList,(e=>(o(),s(el,{key:e.name+e.mac,"device-obj":e,onOpenScan:f},null,8,["device-obj"])))),128))]),p(ne,{show:b.scanShow,"onUpdate:show":l[0]||(l[0]=e=>b.scanShow=e),onOpenDiaShow:_},null,8,["show"])])),[[t,b.loading]])}}},nl={class:"device-multi"},dl={class:"device-multi-top"},cl=["src"],rl={class:"device-multi-top-font"},ul={class:"device-button-row"},ml=["src"],vl=["src"],pl=["src"],hl={class:"device-multi-list"},bl={__name:"multi-device",setup(l){const{t:t}=A();H();const a=ae(),s=J(),u=e({pannelList:[],allSelected:!1,isSelected:!0,dialogShow:!1,resetObj:{}});g((()=>{m()}));const m=()=>{a.componentObjFun.cardFun=()=>{const e=a.tableList.map((e=>{let l=!1;const t=u.pannelList.find((l=>l.ip===e.ip));return t&&(l=t.selected),{...e,selected:l}}));u.pannelList=e},a.getPannelList()},v=()=>{u.pannelList=u.pannelList.map((e=>({...e,selected:!!e.online&&u.allSelected}))),h()},h=()=>{u.isSelected=!u.pannelList.some((e=>e.selected))},b=()=>u.pannelList.filter((e=>e.selected)).map((e=>e.device_id)),_=e=>{u.resetObj=y[e],u.dialogShow=!0},f=()=>{u.okLoading=!0,u.resetObj.submit(),setTimeout((()=>{u.okLoading=!1,u.dialogShow=!1}),3e3)},y={factory:{text:t("Do you want to reset to factory? All data will be cleared and the sub-device will be unbound."),submit:()=>{const e=b();s.setCtrlPanel("reset_factory",e)}},installer:{text:t("Do you want to reset to installer setting? Your device will be restored to its original state."),submit:()=>{const e=b();s.setCtrlPanel("reset",e)}},reboot:{text:t("Do you want to reboot right now?"),submit:()=>{const e=b();s.setCtrlPanel("reboot",e)}}};return(e,l)=>{const t=x,a=L,s=P,m=$;return o(),n("div",nl,[d("div",dl,[d("img",{alt:"smart home,home automation,homekit,smart security,smart home systems,google home",class:"device-multi-top__img",src:r(R)("home/home_device.webp")},null,8,cl),d("div",rl,c(e.$t("Multi-device Operation")),1)]),d("div",ul,[p(t,{type:"primary",class:"device-button-local",size:"large",disabled:u.isSelected,onClick:l[0]||(l[0]=e=>_("reboot"))},{default:i((()=>[d("img",{alt:"smart home,home automation,homekit,smart security,smart home systems,google home",class:"device-search-row__img",src:r(R)("home/reboot.webp")},null,8,ml),w(" "+c(e.$t("Reboot")),1)])),_:1},8,["disabled"]),p(t,{type:"primary",size:"large",class:"device-button-local",disabled:u.isSelected,onClick:l[1]||(l[1]=e=>_("factory"))},{default:i((()=>[d("img",{alt:"smart home,home automation,homekit,smart security,smart home systems,google home",class:"device-search-row__img",src:r(R)("home/update_setting.webp")},null,8,vl),w(" "+c(e.$t("Reset To Factory Setting")),1)])),_:1},8,["disabled"]),p(t,{type:"primary",size:"large",class:"device-button-local",disabled:u.isSelected,onClick:l[2]||(l[2]=e=>_("installer"))},{default:i((()=>[d("img",{alt:"smart home,home automation,homekit,smart security,smart home systems,google home",class:"device-search-row__img",src:r(R)("home/update_setting.webp")},null,8,pl),w(" "+c(e.$t("Reset to Installer Setting")),1)])),_:1},8,["disabled"])]),d("div",hl,[p(m,{data:u.pannelList,"header-cell-style":r(oe),"cell-style":r(se),"max-height":"600",style:j({width:"calc(100vw - 270px)"}),"highlight-current-row":"","scrollbar-always-on":""},{default:i((()=>[p(s,{label:e.$t("All"),width:"100"},{header:i((()=>[p(a,{modelValue:u.allSelected,"onUpdate:modelValue":l[3]||(l[3]=e=>u.allSelected=e),label:e.$t("All"),size:"large",onChange:v},null,8,["modelValue","label"])])),default:i((e=>{var l;return[p(a,{modelValue:e.row.selected,"onUpdate:modelValue":l=>e.row.selected=l,class:"device-el-checkbox",disabled:!(null==(l=e.row)?void 0:l.online),size:"large","device-check":e.row.name,onChange:l=>(e=>{const l=u.pannelList.every((e=>e.selected));u.allSelected=l,h()})(e.row)},null,8,["modelValue","onUpdate:modelValue","disabled","device-check","onChange"])]})),_:1},8,["label"]),p(s,{label:e.$t("Name")},{default:i((e=>[w(c(e.row.name),1)])),_:1},8,["label"]),p(s,{label:e.$t("IP Address")},{default:i((e=>{var l;return[w(c(null==(l=e.row)?void 0:l.ip),1)]})),_:1},8,["label"]),p(s,{label:e.$t("Model")},{default:i((e=>[w(c(e.row.device_type),1)])),_:1},8,["label"]),p(s,{label:e.$t("Software Version")},{default:i((e=>{var l;return[w(c(null==(l=e.row)?void 0:l.software),1)]})),_:1},8,["label"]),p(s,{label:e.$t("Hardware Version")},{default:i((e=>{var l;return[w(c(null==(l=e.row)?void 0:l.hardware),1)]})),_:1},8,["label"])])),_:1},8,["data","header-cell-style","cell-style","style"])]),p(B,{show:u.dialogShow,"onUpdate:show":l[4]||(l[4]=e=>u.dialogShow=e),"button-cancel-show":!0,"button-ok-name":e.$t("Confirm"),"ok-loading":u.okLoading,onButtonCancel:l[5]||(l[5]=e=>u.dialogShow=!1),onButtonConfirm:f},{content:i((()=>[d("div",null,c(u.resetObj.text),1)])),_:1},8,["show","button-ok-name","ok-loading"])])}}},gl={class:"device-local"},wl={class:"device-local-top"},_l=["src"],fl={class:"device-local-top-font"},yl={class:"device-button-row"},Cl={class:"device-button-row-left"},kl={class:"device-search-row"},Sl={class:"device-search-row-text"},jl={class:"device-search-row"},xl={class:"device-search-row-text"},Ll={class:"device-button-row-left"},Pl=["src"],$l=["src"],Ol={class:"device-local-list"},Dl=["onClick"],Vl={class:"device-button-row device-button-bottom"},Nl={class:"device-button-row-left"},Tl=["src"],Ul=["src"],Al={class:"device-button-row-left"},Il={class:"device-page-number"},Ml={class:"device-search-row device-search-page"},Rl={__name:"local-contacts",setup(t){const u=ie(),{t:_}=A(),f=W();let y=H(),C=ae();const T=b(null),U={0:_("Door Phone"),1:_("Guard phone"),2:_("Indoor Monitor"),3:_("Camera")},I={more:_("Do you want to delete the contact?"),all:_("Do you want to delete the all contact?")},M=l((()=>{var e;return!!(null==(e=z.localContacts)?void 0:e.length)&&z.localContacts.every((e=>e.selected))})),z=e({loading:!1,allLocalContacts:[],localContacts:[],contactsType:-1,searchText:"",allSelected:!1,isSelected:!0,exportDisable:!1,nowPage:1,inputPage:1,pageNumber:10,totalPage:10,deleteDialogShow:!1,deleteType:"",deleteText:"",deleteLoading:!1,upLoading:!1});g((()=>{y.setUpModeObj=C.newControlObj,C.localRefreshFun=q,F()})),S((()=>{y.setUpModeObj={},C.localRefreshFun=""}));const F=()=>{z.loading=!0,setTimeout((()=>{z.loading=!1}),2e4);C.getLocalContactsList((()=>{z.loading=!1,z.allLocalContacts=C.loaclContactsList.map(((e,l)=>({...e,searchName:e.call_num+e.name+(null==U?void 0:U[null==e?void 0:e.type]),selected:!1,newIndex:l+1}))),z.totalPage=Math.ceil(z.allLocalContacts.length/z.pageNumber),z.totalPage||(z.totalPage=1),le()}))},q=e=>{const l=e.map(((e,l)=>{const t=z.localContacts.find((l=>(null==e?void 0:e.id)===l.id));let a=!1;return t&&"selected"in t&&(a=t.selected),{...e,searchName:e.call_num+e.name+(null==U?void 0:U[null==e?void 0:e.type]),selected:a,newIndex:l+1}}));z.allLocalContacts=l,z.totalPage=Math.ceil(z.allLocalContacts.length/z.pageNumber),z.totalPage||(z.totalPage=1),le()},G=()=>{z.localContacts=z.localContacts.map((e=>({...e,selected:!M.value}))),K()},K=()=>{z.isSelected=!z.localContacts.some((e=>e.selected))},Q=e=>{const l=z.nowPage+("+"===e?1:-1);l>0&&l<=z.totalPage&&(z.nowPage=l,z.inputPage=z.nowPage,le())},X=()=>{const e=Z(z.inputPage),l=z.inputPage>=0&&z.inputPage<=z.totalPage,t=/^[1-9]\d*$/.test(z.inputPage);e&&l&&t||(z.inputPage=z.nowPage,E(_("Input Error"),"error"))},Y=()=>{z.contactsType=-1,le()},J=()=>{z.searchText="",le()},ee=()=>{z.nowPage=+z.inputPage,le()},le=e=>{"search"===e&&(z.nowPage=1,z.inputPage=1);const l=(z.nowPage-1)*z.pageNumber,t=z.nowPage*z.pageNumber,a=z.allLocalContacts.filter((e=>{let l=Number(e.type)===z.contactsType;-1===z.contactsType&&(l=!0);let t=e.searchName.includes(z.searchText);return z.searchText||(t=!0),l&&t})).map((e=>({...e,selected:e.selected})));z.localContacts=a.slice(l,t),z.totalPage=Math.ceil(a.length/z.pageNumber),z.totalPage||(z.totalPage=1),z.nowPage>z.totalPage&&Q("-"),K()},te=e=>{z.deleteText=I[e],z.deleteType=e,z.deleteDialogShow=!0},ne=()=>{z.deleteDialogShow=!1},ce=()=>{let e=[];e="all"===z.deleteType?z.allLocalContacts.map((e=>e.id)):z.localContacts.filter((e=>e.selected)).map((e=>e.id));z.deleteLoading=!0,setTimeout((()=>{z.deleteLoading=!1}),2e4),C.deleteLocalList((e=>{if(!(null==e?void 0:e.success))return E(_("errorMessage"),"error");ne(),F(),z.deleteLoading=!1}),e)},re=()=>{T.value.changeShow()},ue=(e,l)=>{const t=e.name.endsWith(".csv");if(!t)return E(_("Please select a valid file to upgrade."),"error"),l(t);let a=e.size/1024/1024>1;if(a)return E(_("Please upload an file smaller than 1MB."),"error"),l(!a);l(!0)},me=e=>{const l=new FileReader;l.onload=e=>{const l=e.target.result.split(",")[1];z.upLoading=!0;C.importLoaclList((e=>{if(z.upLoading=!1,!(null==e?void 0:e.success))return E(_("errorMessage"),"error");F(),T.value.changeShow()}),l,(e=>{z.upLoading=!1}))},l.readAsDataURL(e)},ve=()=>{z.exportDisable=!0,D({message:_("loading..."),appendTo:"hidden-8850",duration:6e4});C.exportLocalContactList((()=>{z.exportDisable=!1,D.closeAll()}))},pe=()=>{f.push({name:"AddContacts"})};return(e,l)=>{var t;const b=V,g=N,_=x,y=k,C=L,S=P,D=$,A=h;return a((o(),n("div",gl,[d("div",wl,[d("img",{alt:"smart home,home automation,homekit,smart security,smart home systems,google home",class:"device-local-top__img",src:r(R)("home_contacts.webp")},null,8,_l),d("div",fl,c(e.$t("Local Contacts List")),1)]),d("div",yl,[d("div",Cl,[d("div",kl,[d("span",Sl,c(e.$t("Contacts Type"))+":",1),p(g,{modelValue:z.contactsType,"onUpdate:modelValue":l[0]||(l[0]=e=>z.contactsType=e),size:"large",onChange:l[1]||(l[1]=e=>le("search"))},{default:i((()=>[(o(!0),n(m,null,v(r(u),(e=>(o(),s(b,{key:e.value,label:e.label,value:e.value},null,8,["label","value"])))),128))])),_:1},8,["modelValue"]),p(_,{type:"primary",size:"large",onClick:Y},{default:i((()=>[w(c(e.$t("Reset")),1)])),_:1})]),d("div",jl,[d("span",xl,c(e.$t("Search"))+":",1),p(y,{modelValue:z.searchText,"onUpdate:modelValue":l[2]||(l[2]=e=>z.searchText=e),size:"large",onInput:l[3]||(l[3]=e=>le("search"))},null,8,["modelValue"]),p(_,{type:"primary",size:"large",onClick:J},{default:i((()=>[w(c(e.$t("Reset")),1)])),_:1})])]),d("div",Ll,[p(_,{type:"primary",size:"large",icon:r(O),onClick:pe},{default:i((()=>[w(c(e.$t("Add")),1)])),_:1},8,["icon"]),p(_,{type:"primary",class:"device-button-local",size:"large",onClick:re},{default:i((()=>[d("img",{alt:"smart home,home automation,homekit,smart security,smart home systems,google home",class:"device-search-row__img",src:r(R)("home/import.webp")},null,8,Pl),w(" "+c(e.$t("Import")),1)])),_:1}),p(_,{type:"primary",size:"large",class:"device-button-local",disabled:z.exportDisable,onClick:ve},{default:i((()=>[d("img",{alt:"smart home,home automation,homekit,smart security,smart home systems,google home",class:"device-search-row__img",src:r(R)("home/export.webp")},null,8,$l),w(" "+c(e.$t("Export")),1)])),_:1},8,["disabled"])])]),d("div",Ol,[p(D,{data:z.localContacts,"header-cell-style":r(oe),"cell-style":r(se),style:j({width:"calc(100vw - 270px)"}),"highlight-current-row":"","scrollbar-always-on":""},{default:i((()=>[p(S,{label:e.$t("Index"),width:"100"},{header:i((()=>[p(C,{"model-value":M.value,label:e.$t("Index"),size:"large",onChange:G},null,8,["model-value","label"])])),default:i((e=>[p(C,{modelValue:e.row.selected,"onUpdate:modelValue":l=>e.row.selected=l,"local-name":e.row.name,label:e.row.newIndex,size:"large",onChange:l=>(e.row,void K())},null,8,["modelValue","onUpdate:modelValue","local-name","label","onChange"])])),_:1},8,["label"]),p(S,{label:e.$t("Name")},{default:i((e=>[w(c(e.row.name),1)])),_:1},8,["label"]),p(S,{label:e.$t("IP")},{default:i((e=>[w(c(e.row.call_num),1)])),_:1},8,["label"]),p(S,{label:e.$t("Contacts Type")},{default:i((e=>{var l;return[w(c((null==U?void 0:U[null==(l=e.row)?void 0:l.type])||"--"),1)]})),_:1},8,["label"]),p(S,{label:e.$t("edit"),width:"150"},{default:i((e=>[d("div",{class:"device__name__svg",onClick:l=>{return t=e.row,void f.push({name:"AddContacts",query:{id:t.id}});var t}},null,8,Dl)])),_:1},8,["label"])])),_:1},8,["data","header-cell-style","cell-style","style"]),d("div",Vl,[d("div",Nl,[p(_,{type:"danger",disabled:z.isSelected,size:"large",class:"device-button-local",onClick:l[4]||(l[4]=e=>te("more"))},{default:i((()=>[d("img",{alt:"smart home,home automation,homekit,smart security,smart home systems,google home",class:"device-search-row__img",src:r(R)("home/delete.webp")},null,8,Tl),w(" "+c(e.$t("Delete")),1)])),_:1},8,["disabled"]),p(_,{type:"danger",class:"device-button-local",disabled:!(null==(t=z.allLocalContacts)?void 0:t.length),size:"large",onClick:l[5]||(l[5]=e=>te("all"))},{default:i((()=>[d("img",{alt:"smart home,home automation,homekit,smart security,smart home systems,google home",class:"device-search-row__img",src:r(R)("home/delete.webp")},null,8,Ul),w(" "+c(e.$t("Delete All")),1)])),_:1},8,["disabled"])]),d("div",Al,[d("div",{class:"common-row-triangle-left",onClick:l[6]||(l[6]=e=>Q("-"))}),d("div",Il,c(z.nowPage+"/"+z.totalPage),1),d("div",{class:"common-row-triangle-right",onClick:l[7]||(l[7]=e=>Q("+"))}),d("div",Ml,[p(y,{modelValue:z.inputPage,"onUpdate:modelValue":l[8]||(l[8]=e=>z.inputPage=e),size:"large",onBlur:X},null,8,["modelValue"]),p(_,{type:"primary",size:"large",disabled:1===z.totalPage,onClick:ee},{default:i((()=>[w(c(e.$t("Page")),1)])),_:1},8,["disabled"])])])])]),p(B,{show:z.deleteDialogShow,"onUpdate:show":l[9]||(l[9]=e=>z.deleteDialogShow=e),"button-cancel-show":!0,"ok-loading":z.deleteLoading,"button-ok-name":e.$t("Confirm"),onButtonCancel:ne,onButtonConfirm:ce},{content:i((()=>[d("div",null,c(z.deleteText),1)])),_:1},8,["show","ok-loading","button-ok-name"]),p(de,{ref_key:"fileRef",ref:T,accept:".csv",loading:z.upLoading,"is-top-set":!0,onBeforeUpdate:ue,onUpload:me},null,8,["loading"])])),[[A,z.loading]])}}},zl={class:"device-cloud"},Bl={class:"device-cloud-top"},Fl=["src"],El={class:"device-cloud-top-font"},ql={class:"device-cloud-list"},Wl=["onClick"],Hl={class:"device-dialog-box"},Gl={__name:"cloud-contacts",setup(t){const{t:s}=A();H();let u=ae();const m=e({loading:!1,cloudContactsList:[],dialogShow:!1,isSelected:!0,dialogShow:!1}),v=l((()=>{var e;return!!(null==(e=m.cloudContactsList)?void 0:e.length)&&m.cloudContactsList.every((e=>e.selected))})),_=b(null),f=e({name:"",ip:"",passwd:"",selected:""}),y=(e,l,t)=>{if(!l)return t();const a=ee(l)>20,o=le(l);return a||o?t(s("Please enter content that only contains numbers, letters, and underscores")):t()},C=e({user:[{required:!1,validator:y,trigger:"change"}],passwd:[{required:!1,validator:y,trigger:"change"}]});g((()=>{S()}));const S=()=>{m.loading=!0,setTimeout((()=>{m.loading=!1}),2e4);u.getCloundContactsList((()=>{m.loading=!1,m.cloudContactsList=u.cloundContactsList.map((e=>({...e,selected:!!e.enable_http_unlock})))}))},x=()=>{m.cloudContactsList=m.cloudContactsList.map((e=>({...e,selected:!v.value}))),m.cloudContactsList.forEach((e=>D(e))),O()},O=()=>{m.isSelected=!m.cloudContactsList.some((e=>e.selected))},D=e=>{const l=te(e);l.enable_http_unlock=l.selected?1:0,delete l.selected;u.setCloundContactsList((()=>{S(),m.dialogShow=!1}),l)},V=()=>{_.value.validate((e=>{e&&D(f)}))};return(e,l)=>{const t=P,s=L,u=$,b=T,g=k,y=U,S=h;return a((o(),n("div",zl,[d("div",Bl,[d("img",{alt:"smart home,home automation,homekit,smart security,smart home systems,google home",class:"device-cloud-top__img",src:r(R)("home_contacts.webp")},null,8,Fl),d("div",El,c(e.$t("Cloud Contacts")),1)]),d("div",ql,[p(u,{data:m.cloudContactsList,"header-cell-style":r(oe),"cell-style":r(se),style:j({width:"calc(100vw - 270px)"}),"highlight-current-row":"","scrollbar-always-on":""},{default:i((()=>[p(t,{label:e.$t("Name")},{default:i((e=>{var l;return[w(c(null==(l=e.row)?void 0:l.name),1)]})),_:1},8,["label"]),p(t,{label:e.$t("IP")},{default:i((e=>{var l;return[w(c(null==(l=e.row)?void 0:l.ip),1)]})),_:1},8,["label"]),p(t,{label:e.$t("Username")},{default:i((e=>{var l;return[w(c(null==(l=e.row)?void 0:l.user),1)]})),_:1},8,["label"]),p(t,{label:e.$t("Password")},{default:i((e=>{var l;return[w(c(null==(l=e.row)?void 0:l.passwd),1)]})),_:1},8,["label"]),p(t,{label:e.$t("edit"),width:"150"},{default:i((e=>[d("div",{class:"device__name__svg",onClick:l=>(e=>{for(let l in e)f[l]=e[l];m.dialogShow=!0})(null==e?void 0:e.row)},null,8,Wl)])),_:1},8,["label"]),p(t,{label:e.$t("Enable"),width:"150"},{header:i((()=>[p(s,{"model-value":v.value,label:e.$t("Enable"),size:"large",onChange:x},null,8,["model-value","label"])])),default:i((e=>[p(s,{modelValue:e.row.selected,"onUpdate:modelValue":l=>e.row.selected=l,size:"large",onChange:l=>{return t=e.row,D(t),void O();var t}},null,8,["modelValue","onUpdate:modelValue","onChange"])])),_:1},8,["label"])])),_:1},8,["data","header-cell-style","cell-style","style"])]),p(B,{show:m.dialogShow,"onUpdate:show":l[3]||(l[3]=e=>m.dialogShow=e),class:"device-cloud-dialog","button-cancel-show":!0,"button-ok-name":e.$t("Confirm"),onButtonCancel:l[4]||(l[4]=e=>m.dialogShow=!1),onButtonConfirm:V},{content:i((()=>[d("div",Hl,[p(y,{ref_key:"ruleFormRef",ref:_,model:f,rules:C},{default:i((()=>[p(b,{label:e.$t("Name"),"label-width":"110"},{default:i((()=>[w(c(f.name),1)])),_:1},8,["label"]),p(b,{label:e.$t("IP"),"label-width":"110"},{default:i((()=>[w(c(f.ip),1)])),_:1},8,["label"]),p(b,{label:e.$t("Username"),prop:"user","label-width":"110"},{default:i((()=>[p(g,{modelValue:f.user,"onUpdate:modelValue":l[0]||(l[0]=e=>f.user=e),placeholder:"",maxlength:20},null,8,["modelValue"])])),_:1},8,["label"]),p(b,{label:e.$t("Password"),prop:"passwd","label-width":"110"},{default:i((()=>[p(g,{modelValue:f.passwd,"onUpdate:modelValue":l[1]||(l[1]=e=>f.passwd=e),placeholder:"",maxlength:20},null,8,["modelValue"])])),_:1},8,["label"]),p(b,{label:e.$t("Enable"),"label-width":"110"},{default:i((()=>[p(s,{modelValue:f.selected,"onUpdate:modelValue":l[2]||(l[2]=e=>f.selected=e),size:"large"},null,8,["modelValue"])])),_:1},8,["label"])])),_:1},8,["model","rules"])])])),_:1},8,["show","button-ok-name"])])),[[S,m.loading]])}}},Kl={class:"setup-mode"},Ql={class:"setup-mode-top"},Xl={class:"setup-mode-bottom"},Yl={__name:"index",setup:e=>(e,l)=>(o(),n("div",Kl,[d("div",Ql,c(e.$t("Setup Mode")),1),p(il),d("section",Xl,[p(bl),p(Rl),p(Gl)])]))};export{Yl as default};
