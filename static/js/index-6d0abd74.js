import{r as e,b as a,l as o,p as r,bt as l,bd as s,v as t,b4 as n,b5 as i,q as d,bc as c,b7 as m,ba as g,F as p,bl as u,b9 as b,bf as v,cg as f,bw as h,bx as w,bj as y,bz as k,bn as j,bA as L,bk as S,bB as A,bh as _}from"./Akubela-element-plus-Vendor-47553b40.js";import{_ as z}from"./index-d8b1faeb.js";import{_ as T}from"./index-722e1dac.js";import{o as x,u as C,ba as P,n as E}from"./Akubela-login-home-part-Vendor-facddf88.js";import{s as $}from"./config-178dd060.js";import"./Akubela-devices-img-Vendor-0f46fa2c.js";import"./Akubela-scenes-security-other-img-Vendor-2a1534ad.js";const V={class:"hidden-8850"},F={class:"card-header"},R={class:"engr-common-row"},U={class:"engr-common-row-left"},O={class:"engr-common-row-right"},D={class:"engr-common-row"},M={class:"engr-common-row-left"},B={class:"engr-common-row-right"},W={class:"engr-common-row"},H={class:"engr-common-row-left"},N={class:"engr-common-row-right"},q={class:"engr-common-row"},I={class:"engr-common-row-left"},G={class:"engr-common-row-right"},J={class:"card-header"},K={class:"engr-common-row engr-account-row"},Q={class:"engr-common-row-left"},X={class:"engr-common-row-right"},Y={class:"engr-common-row-right__span"},Z={class:"engr-common-row"},ee={class:"engr-common-row-left"},ae={class:"engr-common-row-right engr-common-row-right-pacp"},oe={key:0},re={class:"card-header"},le={class:"engr-common-row"},se={class:"engr-common-row-left"},te={class:"engr-common-row-right engr-common-row-right-pacp"},ne={class:"engr-popover-pop-main"},ie={__name:"index",setup(ie){const de=x(),{t:ce}=C(),me=e(null),ge=e(null),pe=[{value:"0",label:0},{value:"1",label:1},{value:"2",label:2},{value:"3",label:3},{value:"4",label:4},{value:"5",label:5},{value:"6",label:6},{value:"7",label:7}];let ue=a({loading:!1,exportDisable:!1,upLoading:!1,logLevel:"",logEnable:!1,remoteServer:"",specificPort:"",pcapAutoRefresh:!1,importFormat:".xml"});const be=a({remoteServer:[{validator:(e,a,o)=>{o()},trigger:"change"}],specificPort:[{validator:(e,a,o)=>{if(a){P(a)||o("Please enter a valid number.");const e=Number(a);(e<1||e>65535)&&o("Please enter a valid number.")}o()},trigger:"change"}]});o((()=>{ve()}));const ve=()=>{ue.loading=!0,setTimeout((()=>{ue.loading=!1}),2e4);$.getHiddenPage((e=>{if(ue.loading=!1,e)for(let a in e)ue[a]=e[a]}))},fe=()=>{me.value.validate((e=>{if(e){const e={...ue,logEnable:ue.logEnable?"1":"0"};$.setHiddenPage(e,ve)}}))},he=()=>{var e;return!((null==(e=ye.pcapObj)?void 0:e.fileSize)&&!ye.socket)},we=()=>{ue.exportDisable=!0,f({message:ce("loading..."),appendTo:"hidden-8850",duration:6e4});$.logExport((()=>{ue.exportDisable=!1,f.closeAll()}))},ye=a({status:!1,socket:"",view:"",messageArrays:Array(),messageCount:0,messageTotalLength:"",strLink:"",pcapObj:{fileSize:""}}),ke=a({socket:"",view:"",messageArrays:Array(),messageCount:0,messageTotalLength:0,strLink:""}),je=()=>{$.pcapStart(1,(()=>{try{ye.pcapObj.fileSize=0,ye.status=!0,ke.view="",ke.messageArrays=Array(),ke.messageCount=0,ke.messageTotalLength=0,ke.strLink="",ke.strLink="ws://"+window.location.hostname+":8089",ke.socket=new WebSocket(ke.strLink)}catch(e){return alert("error"),-1}ke.socket.onopen=Se,ke.socket.onerror=e=>{alert("error "+e)},ke.socket.onmessage=Ae,ke.socket.onclose=Le}))},Le=()=>{},Se=()=>{ke.socket.send("akuvoxpcap")},Ae=e=>{let a=new FileReader;a.onload=function(e){e.target.readyState==FileReader.DONE&&(ke.messageArrays[ke.messageCount]=new Uint8Array(e.target.result),ke.messageCount=ke.messageCount+1,ke.messageTotalLength=ke.messageTotalLength+e.target.result.byteLength,ke.messageTotalLength<1024?ye.pcapObj.fileSize=Math.round(ke.messageTotalLength)+"byte":ke.messageTotalLength<1048576?ye.pcapObj.fileSize=Math.round(ke.messageTotalLength/1024)+"kb":ye.pcapObj.fileSize=Math.round(ke.messageTotalLength/1048576*100)/100+"mb")},a.readAsArrayBuffer(e.data)},_e=()=>{ke.socket.close(),ke.status=!1,ue.loading=!0,setTimeout((()=>{$.pcapStart(0),ye.status=!1,ue.loading=!1}),2500)},ze=()=>{if(!ke.messageTotalLength)return E(ce("ToneFileSizeWarning"));ke.view=new Uint8Array(ke.messageTotalLength);let e=0;for(let l=0;l<ke.messageCount;l++)ke.view.set(ke.messageArrays[l],e),e+=ke.messageArrays[l].length;let a="phone.pcap",o=new Blob([ke.view],{type:"application/octet-binary"}),r=document.createElement("a");r.href=URL.createObjectURL(o),r.download=a,r.innerHTML=a,document.body.appendChild(r),r.click(),r.remove()},Te=(e,a)=>{const o=e.name.endsWith(ue.importFormat);if(".js"===ue.importFormat){if(!["de.js","en.js","es.js","fr.js","it.js","ja.js","ko.js","nl.js","pl.js","pt.js","ru.js","tr.js","uk.js","zh.js","zhTw.js"].includes(e.name))return E(ce("Please select a valid file to upgrade."),"error"),a(!1)}if(!o)return E(ce("Please select a valid file to upgrade."),"error"),a(o);a(!0)},xe=()=>{ue.importFormat=".xml",ge.value.changeShow()},Ce=()=>{ue.importFormat=".js",ge.value.changeShow()},Pe=()=>{$.transExport((()=>{}))},Ee=(e,a)=>{ue.uploading=!0,"uploadError"===e&&(ue.uploading=!1),"uploadEnd"===e&&(ue.uploading=!1)},$e=e=>{const a=new FileReader,o=".js"===ue.importFormat;a.onload=a=>{const r=a.target.result.split(",")[1];ue.upLoading=!0;$.importTrans((e=>{if(E("Success"),ue.upLoading=!1,!(null==e?void 0:e.success))return E(ce("errorMessage"),"error");ge.value.changeShow(),o&&location.reload(!0)}),r,e.name,(()=>{ge.value.reset(),ue.upLoading=!1}),o)},a.readAsDataURL(e)};return r((()=>{ye.socket&&ye.socket.close()})),(e,a)=>{const o=h,r=w,f=y,x=k,C=j,P=L,E=S,$=l,ie=A,ke=_;return s((n(),i("div",V,[d(ie,{ref_key:"ruleFormRef",ref:me,model:t(ue),class:"hidden-8850-form commen-main-box",rules:be,"label-width":"120px"},{default:c((()=>[d(E,null,{header:c((()=>[m("div",F,[m("span",null,g(e.$t("System Log")),1)])])),default:c((()=>[m("div",R,[m("div",U,g(t(ce)("Log Level")),1),m("div",O,[d(r,{modelValue:t(ue).logLevel,"onUpdate:modelValue":a[0]||(a[0]=e=>t(ue).logLevel=e),size:"large"},{default:c((()=>[(n(),i(p,null,u(pe,(e=>d(o,{key:e.value,label:e.label,value:e.value},null,8,["label","value"]))),64))])),_:1},8,["modelValue"])])]),m("div",D,[m("div",M,g(e.$t("Export Log")),1),m("div",B,[d(f,{type:"primary",size:"large",disabled:t(ue).exportDisable,onClick:we},{default:c((()=>[b(g(e.$t("Export")),1)])),_:1},8,["disabled"])])]),m("div",W,[m("div",H,g(e.$t("Remote System Log Enabled")),1),m("div",N,[d(x,{modelValue:t(ue).logEnable,"onUpdate:modelValue":a[1]||(a[1]=e=>t(ue).logEnable=e),size:"large"},null,8,["modelValue"])])]),m("div",q,[m("div",I,g(e.$t("Remote System Server")),1),m("div",G,[d(P,{label:"",prop:"remoteServer"},{default:c((()=>[d(C,{modelValue:t(ue).remoteServer,"onUpdate:modelValue":a[2]||(a[2]=e=>t(ue).remoteServer=e),disabled:!t(ue).logEnable},null,8,["modelValue","disabled"])])),_:1})])])])),_:1}),d(E,{class:"card-second"},{header:c((()=>[m("div",J,[m("span",null,g(e.$t("PCAP")),1)])])),default:c((()=>{var o;return[m("div",K,[m("div",Q,g(e.$t("PCAP Specific Port")),1),m("div",X,[d(P,{label:"",prop:"specificPort"},{default:c((()=>[d(C,{modelValue:t(ue).specificPort,"onUpdate:modelValue":a[3]||(a[3]=e=>t(ue).specificPort=e)},null,8,["modelValue"])])),_:1}),m("span",Y,g(e.$t("1-65535")),1)])]),m("div",Z,[m("div",ee,g(e.$t("PCAP")),1),m("div",ae,[d(f,{type:"primary",size:"large",disabled:ye.status,onClick:je},{default:c((()=>[b(g(e.$t("Start")),1)])),_:1},8,["disabled"]),d(f,{type:"primary",size:"large",disabled:!ye.status,onClick:_e},{default:c((()=>[b(g(e.$t("Stop")),1)])),_:1},8,["disabled"]),d(f,{type:"primary",size:"large",disabled:he(),onClick:ze},{default:c((()=>[b(g(e.$t("Export")),1)])),_:1},8,["disabled"]),ye.pcapObj.fileSize?(n(),i("div",oe,g("("+(null==(o=ye.pcapObj)?void 0:o.fileSize)+")"),1)):v("",!0)])])]})),_:1}),d(E,{class:"card-second"},{header:c((()=>[m("div",re,[m("span",null,g(e.$t("Translate file")),1)])])),default:c((()=>[m("div",le,[m("div",se,g(e.$t("Translate file")),1),m("div",te,[d($,{width:"300",placement:"top-start","popper-class":"engr-popover-pop",trigger:"hover"},{reference:c((()=>[d(f,{type:"primary",size:"large"},{default:c((()=>[b(g(e.$t("Import")),1)])),_:1})])),default:c((()=>[m("div",ne,[d(f,{type:"primary",size:"large",onClick:Ce},{default:c((()=>[b(g(e.$t("Web")),1)])),_:1}),d(f,{type:"primary",size:"large",class:"",onClick:xe},{default:c((()=>[b(g(t(de).deviceModel),1)])),_:1})])])),_:1}),d(f,{type:"primary",size:"large",onClick:Pe},{default:c((()=>[b(g(e.$t("Export")),1)])),_:1})])])])),_:1})])),_:1},8,["model","rules"]),d(z,{ref_key:"transFileRef",ref:ge,accept:t(ue).importFormat,loading:t(ue).upLoading,"is-top-set":!0,onBeforeUpdate:Te,onUpload:$e,onLoadingChange:Ee},null,8,["accept","loading"]),d(T,{onCancel:ve,onSubmit:fe})])),[[ke,t(ue).loading]])}}};export{ie as default};
