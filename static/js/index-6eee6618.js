import{b as e,l as a,w as l,cp as s,c6 as t,bi as r,bd as o,b4 as i,b5 as n,q as d,bc as c,b7 as u,ba as m,b9 as p,v as g,cq as v,bm as w,bn as f,bk as b,bz as h,bh as _}from"./Akubela-element-plus-Vendor-47553b40.js";import{u as V,w as y,n as I,m as z,s as k}from"./Akubela-login-home-part-Vendor-facddf88.js";import{_ as P}from"./index-722e1dac.js";import{e as $}from"./config-178dd060.js";import"./Akubela-devices-img-Vendor-0f46fa2c.js";import"./Akubela-scenes-security-other-img-Vendor-2a1534ad.js";const j={class:"api-connection-index"},x={class:"card-header"},D={class:"engr-common-row"},L={class:"engr-common-row-left"},U={class:"engr-common-row-right"},A={class:"engr-common-row"},M={class:"engr-common-row-left"},q=u("div",{class:"engr-common-row-right"},null,-1),C={class:"card-header"},S={class:"white-list-content"},E={__name:"index",setup(E){const{t:G}=V();let H=y();const R=e({loading:!1,recevieData:{},mode:1,url:"",enable:!1,allowList:""}),T=()=>new Promise(((e,a)=>{var l;R.recevieData[H.wId]=l=>{var s,t;l.success?(e(),R.mode=null==(s=l.result)?void 0:s.mode,R.url=null==(t=l.result)?void 0:t.url):(a(),I(G("errorMessage"),"error"))};const s={type:"ak_api/config/get",config_type:"api_server_info",id:H.wId++};null==(l=H.ws)||l.send(z(s))})),W=()=>new Promise(((e,a)=>{var l;R.recevieData[H.wId]=l=>{var s,t,r;if(!l.success)return a(),I(G("errorMessage"),"error");e(),R.allowList=null==(t=null==(s=l.result)?void 0:s.list)?void 0:t.join(";"),R.enable=0!==(null==(r=l.result)?void 0:r.enable)};const s={type:"ak_api/config/get",config_type:"api_white_list",id:H.wId++};null==(l=H.ws)||l.send(z(s))})),B=()=>{var e;const a=null==(e=R.allowList)?void 0:e.replace(/;$/,""),l=null==a?void 0:a.split(";");return new Promise(((e,a)=>{var s;if(l.length>10)return a(),I("白名单最多支持配置10个","error");R.recevieData[H.wId]=l=>{if(!l.success)return a(),I(G("errorMessage"),"error");e()};const t={type:"ak_api/config/set",config_type:"api_white_list",param:{list:l,enable:R.enable?1:0},id:H.wId++};null==(s=H.ws)||s.send(z(t))}))};a((()=>{R.loading=!0,Promise.all([T(),W()]).then((([e,a])=>{R.loading=!1})).catch((e=>{R.loading=!1}))}));const F=()=>{T(),W()},J=()=>{R.loading=!0,Promise.all([new Promise(((e,a)=>{var l;R.recevieData[H.wId]=l=>{l.success?e():(a(),I(G("errorMessage"),"error"))};const s={type:"ak_api/config/set",config_type:"api_server_info",param:{mode:R.mode,url:R.url},id:H.wId++};null==(l=H.ws)||l.send(z(s))})),B()]).then((([e,a])=>{I("保存成功！"),R.loading=!1})).catch((e=>{R.loading=!1}))};return l((()=>H.updataId),(e=>{k(R.recevieData,e,H)}),{immediate:!0}),(e,a)=>{const l=s,V=f,y=b,I=t,z=r,k=h,E=_;return o((i(),n("div",j,[d(y,{class:"card-part"},{header:c((()=>[u("div",x,[u("span",null,m(e.$t("Global server address")),1)])])),default:c((()=>[u("div",D,[u("div",L,[d(l,{modelValue:R.mode,"onUpdate:modelValue":a[0]||(a[0]=e=>R.mode=e),label:0,size:"large"},{default:c((()=>[p(m(e.$t("Client mode")),1)])),_:1},8,["modelValue"])]),u("div",U,[d(V,{modelValue:R.url,"onUpdate:modelValue":a[1]||(a[1]=e=>R.url=e),class:"http-input",placeholder:e.$t("Please enter"),size:g($)},{prepend:c((()=>[p("Http://")])),_:1},8,["modelValue","placeholder","size"])])]),u("div",A,[u("div",M,[d(l,{modelValue:R.mode,"onUpdate:modelValue":a[2]||(a[2]=e=>R.mode=e),label:1,size:"large"},{default:c((()=>[p(m(e.$t("Server mode")),1)])),_:1},8,["modelValue"])]),q])])),_:1}),d(y,{class:"card-part"},{header:c((()=>[u("div",C,[u("span",null,m(e.$t("Whitelist")),1),d(z,{class:"box-item",effect:"light",content:e.$t("The whitelist address only restricts visitors. Requests initiated by the local machine are not restricted."),placement:"top","raw-content":!0},{default:c((()=>[d(I,null,{default:c((()=>[d(g(v))])),_:1})])),_:1},8,["content"]),d(k,{modelValue:R.enable,"onUpdate:modelValue":a[3]||(a[3]=e=>R.enable=e),size:g($)},null,8,["modelValue","size"])])])),default:c((()=>[u("div",S,[o(d(V,{modelValue:R.allowList,"onUpdate:modelValue":a[4]||(a[4]=e=>R.allowList=e),class:"input-textarea",placeholder:e.$t("Enter the whitelist IP address. If there are multiple IP addresses, please separate them with semicolons."),type:"textarea",autosize:!1,size:g($)},null,8,["modelValue","placeholder","size"]),[[w,R.enable]])])])),_:1}),d(P,{onCancel:F,onSubmit:J})])),[[E,R.loading]])}}};export{E as default};
