import{r as a,b as e,l as o,w as l,c6 as n,bi as r,bd as s,b4 as t,b5 as i,q as d,bc as c,b7 as u,ba as g,v as p,b9 as k,cq as m,F as f,bl as A,be as b,bj as P,bk as T,bw as I,bx as _,bA as R,bz as v,bB as D,bh as w}from"./Akubela-element-plus-Vendor-47553b40.js";import{_ as h}from"./index-722e1dac.js";import{e as K,l as Y}from"./config-178dd060.js";import{o as H,w as y,u as x,Y as E,n as B,m as N,s as V}from"./Akubela-login-home-part-Vendor-facddf88.js";import{_ as U}from"./index-d8b1faeb.js";import"./Akubela-devices-img-Vendor-0f46fa2c.js";import"./Akubela-scenes-security-other-img-Vendor-2a1534ad.js";const j=["element-loading-text"],$=["element-loading-text"],z={class:"card-header"},C={class:"engr-common-row"},S={class:"engr-common-row-left"},F={class:"engr-common-row-right"},L={class:"configuration"},M={class:"card-header"},q={class:"engr-common-row"},W={class:"engr-common-row-left"},G={class:"engr-common-row-right"},J={class:"engr-common-row"},O={class:"engr-common-row-left"},Q={class:"engr-common-row-right"},X={__name:"index",setup(X){const Z=H();let aa=y();const{t:ea}=x(),oa=a(),la=a(),na=e({configData:{"Indoor.THIRDPARTYAPK.PackageName":"","Indoor.THIRDPARTYAPK.TurnBackApkEnable":!1},recevieData:{},apkArr:[],progress:0,upLoading:!1,loadingText:"",newUploading:!1}),ra=()=>{la.value.changeShow()},sa=()=>{var a;na.recevieData[aa.wId]=a=>{var e,o;if(!a.success)return B(ea("errorMessage"),"error");(null==a?void 0:a.result)&&(na.configData["Indoor.THIRDPARTYAPK.TurnBackApkEnable"]="1"===(null==(e=a.result)?void 0:e["Indoor.THIRDPARTYAPK.TurnBackApkEnable"]),na.configData["Indoor.THIRDPARTYAPK.PackageName"]=null==(o=a.result)?void 0:o["Indoor.THIRDPARTYAPK.PackageName"])};const e={type:"ak_config/get",id:aa.wId++,item:["Indoor.THIRDPARTYAPK.PackageName","Indoor.THIRDPARTYAPK.TurnBackApkEnable"]};null==(a=aa.ws)||a.send(N(e))},ta=()=>{var a;na.recevieData[aa.wId]=a=>{if(na.uploading=!1,!a.success)return B(ea("errorMessage"),"error");na.apkArr=(null==a?void 0:a.result)||[]},na.uploading=!0,setTimeout((()=>{na.uploading=!1}),15e3);const e={type:"apk/get_list",id:aa.wId++};null==(a=aa.ws)||a.send(N(e))},ia={51:"googleinstaller_akubela_android10.apk",71:"googleinstaller_akubela_android10.apk",52:"googleinstaller_akubela_android12.apk",81:"googleinstaller_akubela_android12.apk",281:"googleinstaller_akubela_android12.apk",1001:"googleinstaller_akubela_android12.apk",53:"googleinstaller_akubela_android13.apk",251:"googleinstaller_akubela_android13.apk",933:"googleinstaller_akubela_android9.apk",319:"googleinstaller_akubela_android9.apk",119:"googleinstaller_akubela_android9.apk"},da=(a,e)=>{if(!a.name.endsWith(".apk"))return B(ea("Please select the correct file format"),"error"),e(!1);const o=Z.versionArray[0],l=a.name.toLowerCase();if(l===ia[o])return e(!0);if(l.includes("googleinstaller")){const l=`googleinstaller_akubela_hypanel_${o}.apk`;if(a.name!==l)return B(ea("googerror"),"error"),e(!1)}e(!0)},ca=(a,e)=>{na.loadingText=ea("Please Wait..."),na.newUploading=!0,"uploadEnd"===a&&(ta(),na.newUploading=!1,la.value.closeDialog(),B(ea("App installed successfully!"),"success")),"uploadError"===a&&(na.newUploading=!1)},ua=e({"Indoor.THIRDPARTYAPK.PackageName":[{validator:(a,e,o)=>o(),trigger:"change"}],"Indoor.THIRDPARTYAPK.TurnBackApkEnable":[{validator:(a,e,o)=>o(),trigger:"change"}]}),ga=()=>{},pa=()=>{sa()},ka=()=>{oa.value.validate((async a=>{a&&(()=>{var a;na.recevieData[aa.wId]=a=>{if(na.uploading=!1,!a.success)return B(ea("errorMessage"),"error");B(ea("Submitted successfully!"),"success"),sa()};const e={type:"ak_config/update",id:aa.wId++,item:{"Indoor.THIRDPARTYAPK.PackageName":na.configData["Indoor.THIRDPARTYAPK.PackageName"],"Indoor.THIRDPARTYAPK.TurnBackApkEnable":na.configData["Indoor.THIRDPARTYAPK.TurnBackApkEnable"]?"1":"0"}};na.uploading=!0,setTimeout((()=>{na.uploading=!1}),15e3),null==(a=aa.ws)||a.send(N(e))})()}))};return o((()=>{sa(),ta()})),l((()=>aa.updataId),(a=>{V(na.recevieData,a,aa)}),{immediate:!0}),(a,e)=>{const o=P,l=T,H=n,y=r,x=I,B=_,N=R,V=v,X=D,Z=w;return s((t(),i("div",{class:"third-park-apk","element-loading-text":na.loadingText},[s((t(),i("div",{class:"app-installation","element-loading-text":na.loadingText},[d(l,{class:"app-installation-card"},{header:c((()=>[u("div",z,[u("span",null,g(a.$t("APP Installation")),1)])])),default:c((()=>[u("div",C,[u("div",S,g(a.$t("File"))+"(.apk)",1),u("div",F,[d(o,{"akubela-test":"engr-third-park-apk-import",type:"primary",size:p(K),onClick:ra},{default:c((()=>[k(g(a.$t("Import")),1)])),_:1},8,["size"])])])])),_:1})],8,$)),[[Z,na.newUploading,void 0,{fullscreen:!0,lock:!0}]]),u("div",L,[d(X,{ref_key:"ruleFormRef",ref:oa,model:na.configData,rules:ua,"label-width":p(Y)},{default:c((()=>[d(l,{class:"configuration-card"},{header:c((()=>[u("div",M,[u("span",null,[k(g(a.$t("Third Party APK Configuration"))+" ",1),d(y,{class:"box-item",effect:"light",content:a.$t("Please select an app name for relevant configuration"),placement:"top","raw-content":!0},{default:c((()=>[d(H,null,{default:c((()=>[d(p(m))])),_:1})])),_:1},8,["content"])])])])),default:c((()=>[u("div",q,[u("div",W,g(a.$t("App Name")),1),u("div",G,[d(N,{prop:"Indoor.THIRDPARTYAPK.PackageName"},{default:c((()=>[d(B,{modelValue:na.configData["Indoor.THIRDPARTYAPK.PackageName"],"onUpdate:modelValue":e[0]||(e[0]=a=>na.configData["Indoor.THIRDPARTYAPK.PackageName"]=a),size:p(K)},{default:c((()=>[(t(!0),i(f,null,A(na.apkArr,(a=>(t(),b(x,{key:a.apk_id,label:a.apk_name,value:a.apk_id},null,8,["label","value"])))),128))])),_:1},8,["modelValue","size"])])),_:1})])]),u("div",J,[u("div",O,g(a.$t("Start Up Enabled")),1),u("div",Q,[d(N,{prop:"Indoor.THIRDPARTYAPK.TurnBackApkEnable"},{default:c((()=>[d(V,{modelValue:na.configData["Indoor.THIRDPARTYAPK.TurnBackApkEnable"],"onUpdate:modelValue":e[1]||(e[1]=a=>na.configData["Indoor.THIRDPARTYAPK.TurnBackApkEnable"]=a),size:p(K),onChange:ga},null,8,["modelValue","size"])])),_:1})])])])),_:1})])),_:1},8,["model","rules","label-width"])]),d(h,{onCancel:pa,onSubmit:ka}),d(U,{ref_key:"fileRef",ref:la,accept:".apk","ok-name":"Install","api-fun":p(E).uploadApk,onBeforeUpdate:da,onLoadingChange:ca},null,8,["api-fun"])],8,j)),[[Z,na.uploading]])}}};export{X as default};
