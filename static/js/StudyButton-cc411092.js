import{b as t,j as e,b4 as o,b5 as n,q as a,bc as s,b7 as i,ba as l,v as d,be as u,bf as r,bn as m,r as c,p as h}from"./Akubela-element-plus-Vendor-47553b40.js";import{j as w,e as b,u as p,w as v,P as y,a as f,a0 as B,R as k,n as _,g}from"./Akubela-login-home-part-Vendor-facddf88.js";const S={class:"add-button-name"},D={class:"device-advanced-box-dia"},C={class:"device-advanced-tit"},j={class:"ak-bottom-button-row"},x={class:"add-button-box-text"},$={class:"add-button-box-text"},O={__name:"AddButtonName",props:{show:{type:Boolean,required:!0,default:!1},titleShow:{type:Boolean,required:!1,default:!0}},emits:["update:show","open-dia-show"],setup(c,{expose:h,emit:g}){const O=c;let R=w(),A=b();const{t:E}=p();let q=v();const I=t({acceptData:{},loading:!1,oldname:"",name:"",buttonObj:{device_id:"",entity_id:""},keys:[],editShow:!1,isBackShow:!1,isDeleteShow:!1}),U=e({get:()=>O.show,set:t=>{g("update:show",t)}}),N=B((t=>{if(!(I.name.length<22))for(let e=21;e<I.name.length+1;e++){if(k(I.name.substr(0,e+1))>t){I.name=I.name.substr(0,e);break}}}),500),V=()=>{I.name!==I.oldname?I.isBackShow=!0:z()},M=()=>{G(),I.isBackShow=!1},P=()=>{I.isBackShow=!1,z()},L=()=>{I.isDeleteShow=!I.isDeleteShow},z=()=>{g("open-dia-show"),g("update:show",!1)};h({init:(t,e)=>{I.buttonObj=t,I.loading=!0,A.componentRececieData[null==q?void 0:q.wId]=o=>{var n,a,s,i;I.loading=!1;const l=null==o?void 0:o.result;I.keys=(null==(a=null==(n=null==l?void 0:l.attributes)?void 0:n.find)?void 0:a.call(n,(t=>"remote_buttons"===t.feature)))||[];const d=null==(i=null==(s=I.keys.value)?void 0:s.find)?void 0:i.call(s,(e=>e.entity_id===t.entity_id));(null==d?void 0:d.fname)&&"add"!==e?(I.name=d.fname,I.oldname=d.fname):(I.name=J(),I.oldname=I.name,G("first"))},A.findDetailDevice(t.device_id)}});const F=()=>{if(H(I.name)){A.componentRececieData[null==q?void 0:q.wId]=t=>{if(!t.success)return _(E("errorMessage"),"error");g("update:show",!1),R.buttonChangeShow=!0};const t=[{entity_id:I.buttonObj.entity_id,name:I.name}];A.switchNameChange(t)}},G=t=>{if(H(I.name)){A.componentRececieData[null==q?void 0:q.wId]=e=>{if(!e.success)return _(E("errorMessage"),"error");I.oldname=I.name,"first"!==t&&z()};const e=[{entity_id:I.buttonObj.entity_id,name:"first"===t?E("Button"):I.name}];A.switchNameChange(e)}},H=t=>!!t.trim()||(_(E("nameEmpty"),"error"),!1),J=()=>{var t,e,o,n;let a=1;for(;null==(n=null==(o=null==(e=null==(t=I.keys.value)?void 0:t.filter)?void 0:e.call(t,(t=>t.entity_id!==I.buttonObj.entity_id)))?void 0:o.some)?void 0:n.call(o,(t=>t.fname==="Button"+a));)a+=1;return"Button"+a},K=()=>{A.componentRececieData[null==q?void 0:q.wId]=t=>{L(),z()},A.deleteButtonName(I.buttonObj.entity_id)};return(t,e)=>{const c=m;return o(),n("div",S,[a(f,{show:U.value,"onUpdate:show":e[2]||(e[2]=t=>U.value=t),"foot-show":O.titleShow,"back-show":!0,loading:I.loading,title:O.titleShow?t.$t("Add Button"):"","button-ok-name":t.$t("Next"),onButtonCancel:e[3]||(e[3]=t=>g("update:show",!1)),onButtonBack:V,onButtonConfirm:F},{content:s((()=>[i("div",D,[i("div",C,l(t.$t("Please name the Remote Control Button")),1),a(c,{modelValue:I.name,"onUpdate:modelValue":e[0]||(e[0]=t=>I.name=t),class:"button-name__input",maxlength:63,onInput:e[1]||(e[1]=t=>d(N)(64))},null,8,["modelValue"])]),i("div",j,[O.titleShow?r("",!0):(o(),u(y,{key:0,class:"button-name-delete","class-name":"danger","button-name":t.$t("Delete"),onClick:L},null,8,["button-name"])),O.titleShow?r("",!0):(o(),u(y,{key:1,class:"button-name-primary","class-name":"primary","button-name":t.$t("Done"),onClick:G},null,8,["button-name"]))])])),_:1},8,["show","foot-show","loading","title","button-ok-name"]),a(f,{show:I.isBackShow,"onUpdate:show":e[4]||(e[4]=t=>I.isBackShow=t),"button-cancel-show":!0,"button-ok-name":t.$t("Confirm"),onButtonCancel:P,onButtonConfirm:M},{content:s((()=>[i("div",x,l(t.$t("Do you want to save the changes")),1)])),_:1},8,["show","button-ok-name"]),a(f,{show:I.isDeleteShow,"onUpdate:show":e[5]||(e[5]=t=>I.isDeleteShow=t),"button-cancel-show":!0,"button-ok-name":t.$t("Confirm"),onButtonCancel:L,onButtonConfirm:K},{content:s((()=>[i("div",$,l(t.$t("Do you want to delete this button")),1)])),_:1},8,["show","button-ok-name"])])}}},R={class:"study-button"},A={class:"study-row-box"},E={class:"study-row-text"},q={class:"study-row-text"},I={class:"study-row-text"},U=["src"],N={__name:"StudyButton",props:{show:{type:Boolean,required:!0,default:!1},backShow:{type:Boolean,required:!1,default:!1},type:{type:String,required:!0,default:""},replace:{type:Boolean,required:!1,default:!1}},emits:["update:show","open-dia-show"],setup(u,{expose:r,emit:m}){const y=u,{t:B}=p();let k=w(),{deviceCardObj:S}=k,D=b(),C=v();const j=t({recevieData:{},buttonShow:!1,buttonObj:{name:"",entity_id:""},remoteEntity:""}),x=c(""),$=e({get:()=>y.show,set:t=>{m("update:show",t)}}),N=()=>{D.learnCommand(j.remoteEntity,"end"),m("open-dia-show"),m("update:show",!1)},V=()=>{D.learnCommand(j.remoteEntity,"end"),m("update:show",!1)},M=()=>{P("start"),m("update:show",!0)},P=(t="start")=>{const e=D.findAbility(S.deviceDetail,"remote","learn_command");j.remoteEntity=null==e?void 0:e.entity_id,D.componentRececieData.studtButton=t=>{j.buttonObj=t.payload,D.learnCommand(j.remoteEntity,"end"),m("update:show",!1),x.value.init(j.buttonObj,"add"),delete D.componentRececieData.studtButton,j.buttonShow=!0},D.componentRececieData[null==C?void 0:C.wId]=t=>{var e;if(!t.success)return _(B(null==(e=null==t?void 0:t.error)?void 0:e.code),"error")},D.learnCommand(j.remoteEntity,t)};return h((()=>{delete D.componentRececieData.studtButton})),r({init:P}),(t,e)=>(o(),n("div",R,[a(f,{show:$.value,"onUpdate:show":e[0]||(e[0]=t=>$.value=t),"foot-show":!1,"back-show":y.backShow,title:t.$t("Add Button"),class:"study-button",onButtonBack:N,onButtonCancel:V},{content:s((()=>[i("div",A,[i("div",E,"1."+l(t.$t("EnsureAgain")),1),i("div",q,"2."+l(t.$t("AsLearn")),1),i("div",I,"3."+l(t.$t("IfOnce")),1),i("img",{alt:"smart home,home automation,homekit,smart security,smart home systems,google home",class:"study-big-top__img",src:d(g)("devices_other/cmgmr.webp")},null,8,U)])])),_:1},8,["show","back-show","title"]),a(O,{ref_key:"addbutonname",ref:x,show:j.buttonShow,"onUpdate:show":e[1]||(e[1]=t=>j.buttonShow=t),onOpenDiaShow:M},null,8,["show"])]))}};export{N as _,O as a};
